{
  "hash": "a819d2565cb45df4d04555428aaf8bb4",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Cap√≠tulo 6 ‚Äî Distribuciones de probabilidad (scipy.stats)\"\n---\n\n[üöÄ Abrir este cap√≠tulo en Google Colab](https://colab.research.google.com/github/FraRafa/manual/blob/main/notebooks/06-distribuciones-de-probabilidad.ipynb){.btn .btn-success target=\"_blank\"}\n\n\n::: {.callout-note}\n## Objetivos del cap√≠tulo\n\nVas a aprender a usar `scipy.stats` para:\n\n- calcular **PMF/PDF**, **CDF** y **cuantiles** (`ppf`),\n- graficar PMF/PDF y CDF de forma simple con `matplotlib`,\n- simular variables aleatorias con `rvs` y comparar **muestra vs teor√≠a**,\n- entender (por c√≥digo) qu√© significa ‚Äúpromedio acumulado‚Äù y por qu√© converge a la esperanza.\n:::\n\n::: {.column-margin}\n<details>\n<summary><strong>Glosario</strong></summary>\n\n- **PMF**: *probability mass function* (masa) ‚Üí discretas (`pmf`).\n- **PDF**: *probability density function* (densidad) ‚Üí continuas (`pdf`).\n- **CDF**: *cumulative distribution function* (acumulada) ‚Üí `cdf`.\n- **PPF**: *percent point function* (cuantil) ‚Üí inversa de la CDF (`ppf`).\n- **rvs**: *random variates* ‚Üí simular una muestra (`rvs`).\n- **loc / scale**: par√°metros est√°ndar de `scipy` (inicio y escala).\n</details>\n:::\n\n---\n\n## 1. `scipy.stats`: el patr√≥n de uso\n\nEn `scipy.stats`, muchas distribuciones siguen este patr√≥n:\n\n- Discretas: `pmf(x, ...)` y `cdf(x, ...)`\n- Continuas: `pdf(x, ...)` y `cdf(x, ...)`\n- Cuantiles: `ppf(q, ...)` (por ejemplo, `q=0.95`)\n- Simulaci√≥n: `rvs(..., size=n, random_state=...)`\n\n::: {.callout-note}\n### Sintaxis (plantilla)\n\n- Discreta: `stats.binom.pmf(x, n, p)` / `stats.binom.cdf(x, n, p)`\n- Continua: `stats.norm.pdf(x, mu, sigma)` / `stats.norm.cdf(x, mu, sigma)`\n- Cuantil: `stats.norm.ppf(0.975, mu, sigma)`\n- Simular: `stats.norm.rvs(mu, sigma, size=1000, random_state=123)`\n:::\n\n---\n\n## 2. Distribuciones discretas\n\n### 2.1 Uniforme discreta (`randint`)\n\n::: {#b3d07a74 .cell execution_count=2}\n``` {.python .cell-code}\n# Par√°metros\na = 1  # primer valor\nb = 6  # √∫ltimo valor\n\n# Valores de X (para tabla) y valores para gr√°fica CDF\nx = np.arange(a, b + 1)\nxg = np.arange(a - 1, b + 2)\n\n# PMF y CDF\nfx = stats.randint.pmf(x, a, b + 1)\nFx = stats.randint.cdf(x, a, b + 1)\nFxg = stats.randint.cdf(xg, a, b + 1)\n\ntabla_dist = pd.DataFrame({\"x\": x, \"PMF\": fx, \"CDF\": Fx})\ntabla_dist\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>x</th>\n      <th>PMF</th>\n      <th>CDF</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1</td>\n      <td>0.166667</td>\n      <td>0.166667</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2</td>\n      <td>0.166667</td>\n      <td>0.333333</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>3</td>\n      <td>0.166667</td>\n      <td>0.500000</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>4</td>\n      <td>0.166667</td>\n      <td>0.666667</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>5</td>\n      <td>0.166667</td>\n      <td>0.833333</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>6</td>\n      <td>0.166667</td>\n      <td>1.000000</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {.callout-note}\n### Sintaxis clave (`randint`)\n\n- En `scipy`, `randint(a, b+1)` representa enteros en **[a, b]**.\n- Por eso ver√°s `b+1` en la funci√≥n.\n:::\n\n::: {#b6e7f05e .cell execution_count=3}\n``` {.python .cell-code}\nplt.bar(x, fx, color=\"0.6\", edgecolor=\"black\")\nplt.title(f\"PMF ‚Äî Uniforme discreta: X ~ U{{{a},{b}}}\")\nplt.xlabel(\"x\")\nplt.ylabel(\"f(x)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-4-output-1.png){width=840 height=516}\n:::\n:::\n\n\n::: {#a29e83b7 .cell execution_count=4}\n``` {.python .cell-code}\nplt.step(xg, Fxg, where=\"post\", color=\"black\")\nplt.title(f\"CDF ‚Äî Uniforme discreta: X ~ U{{{a},{b}}}\")\nplt.xlabel(\"x\")\nplt.ylabel(\"F(x)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-5-output-1.png){width=829 height=516}\n:::\n:::\n\n\n---\n\n### 2.2 Bernoulli (`bernoulli`)\n\n::: {#686ebb8a .cell execution_count=5}\n``` {.python .cell-code}\nx = [0, 1]\nxg = np.linspace(-0.1, 1.1, num=1000)\n\np = 0.2\n\nfx = stats.bernoulli.pmf(x, p)\nFx = stats.bernoulli.cdf(x, p)\nFxg = stats.bernoulli.cdf(xg, p)\n\ntabla_dist = pd.DataFrame({\"x\": x, \"PMF\": fx, \"CDF\": Fx})\ntabla_dist\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>x</th>\n      <th>PMF</th>\n      <th>CDF</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0</td>\n      <td>0.8</td>\n      <td>0.8</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1</td>\n      <td>0.2</td>\n      <td>1.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {.callout-note}\n### Sintaxis clave (Bernoulli)\n\n- `x` solo puede ser 0 o 1.\n- `p` es la probabilidad de √©xito (`X=1`).\n:::\n\n::: {#4eba115b .cell execution_count=6}\n``` {.python .cell-code}\nplt.bar(x, fx, color=\"0.6\", edgecolor=\"black\")\nplt.xticks(x, [\"0\", \"1\"])\nplt.title(f\"PMF ‚Äî Bernoulli: X ~ Be({p})\")\nplt.xlabel(\"x\")\nplt.ylabel(\"f(x)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-7-output-1.png){width=829 height=516}\n:::\n:::\n\n\n::: {#684aebc4 .cell execution_count=7}\n``` {.python .cell-code}\nplt.step(xg, Fxg, color=\"black\")\nplt.title(f\"CDF ‚Äî Bernoulli: X ~ Be({p})\")\nplt.xlabel(\"x\")\nplt.ylabel(\"F(x)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-8-output-1.png){width=829 height=516}\n:::\n:::\n\n\n---\n\n### 2.3 Binomial (`binom`)\n\nEjemplo t√≠pico: *n* ensayos Bernoulli independientes con probabilidad de √©xito *p*.\n\n::: {#af89b6ea .cell execution_count=8}\n``` {.python .cell-code}\nx = np.linspace(0, 10, num=11)\nxg = np.linspace(-0.5, 10.1, num=1000)\n\np = 0.2\nn = 10\n\nfx = stats.binom.pmf(x, n, p)\nFx = stats.binom.cdf(x, n, p)\nFxg = stats.binom.cdf(xg, n, p)\n\ntabla_dist = pd.DataFrame({\"x\": x, \"PMF\": fx, \"CDF\": Fx})\ntabla_dist.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>x</th>\n      <th>PMF</th>\n      <th>CDF</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.0</td>\n      <td>0.107374</td>\n      <td>0.107374</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1.0</td>\n      <td>0.268435</td>\n      <td>0.375810</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2.0</td>\n      <td>0.301990</td>\n      <td>0.677800</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>3.0</td>\n      <td>0.201327</td>\n      <td>0.879126</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>4.0</td>\n      <td>0.088080</td>\n      <td>0.967207</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#91b60f68 .cell execution_count=9}\n``` {.python .cell-code}\nplt.bar(x, fx, color=\"0.6\", edgecolor=\"black\")\nplt.title(f\"PMF ‚Äî Binomial: X ~ Bn({n},{p})\")\nplt.xlabel(\"x\")\nplt.ylabel(\"f(x)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-10-output-1.png){width=840 height=516}\n:::\n:::\n\n\n::: {#fbe4b4a1 .cell execution_count=10}\n``` {.python .cell-code}\nplt.step(xg, Fxg, color=\"black\")\nplt.title(f\"CDF ‚Äî Binomial: X ~ Bn({n},{p})\")\nplt.xlabel(\"x\")\nplt.ylabel(\"F(x)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-11-output-1.png){width=829 height=516}\n:::\n:::\n\n\nProbabilidad puntual (ejemplo): `P(X=2)` con `n=10`, `p=0.2`.\n\n::: {#fc912dfe .cell execution_count=11}\n``` {.python .cell-code}\nstats.binom.pmf(2, 10, 0.2)\n```\n\n::: {.cell-output .cell-output-display execution_count=11}\n```\nnp.float64(0.30198988800000004)\n```\n:::\n:::\n\n\n---\n\n### 2.4 Poisson (`poisson`)\n\n::: {#95411c1b .cell execution_count=12}\n``` {.python .cell-code}\nx = np.linspace(0, 15, num=16)\nxg = np.linspace(-0.5, 15, num=1500)\n\nplambda = 4\n\nfx = stats.poisson.pmf(x, plambda)\nFx = stats.poisson.cdf(x, plambda)\nFxg = stats.poisson.cdf(xg, plambda)\n\ntabla_dist = pd.DataFrame({\"x\": x, \"PMF\": fx, \"CDF\": Fx})\ntabla_dist.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=12}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>x</th>\n      <th>PMF</th>\n      <th>CDF</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.0</td>\n      <td>0.018316</td>\n      <td>0.018316</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1.0</td>\n      <td>0.073263</td>\n      <td>0.091578</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2.0</td>\n      <td>0.146525</td>\n      <td>0.238103</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>3.0</td>\n      <td>0.195367</td>\n      <td>0.433470</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>4.0</td>\n      <td>0.195367</td>\n      <td>0.628837</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#ae84a87b .cell execution_count=13}\n``` {.python .cell-code}\nplt.bar(x, fx, color=\"0.6\", edgecolor=\"black\")\nplt.title(f\"PMF ‚Äî Poisson: X ~ Poi({plambda})\")\nplt.xlabel(\"x\")\nplt.ylabel(\"f(x)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-14-output-1.png){width=853 height=516}\n:::\n:::\n\n\n::: {#16926ba9 .cell execution_count=14}\n``` {.python .cell-code}\nplt.step(xg, Fxg, color=\"black\")\nplt.title(f\"CDF ‚Äî Poisson: X ~ Poi({plambda})\")\nplt.xlabel(\"x\")\nplt.ylabel(\"F(x)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-15-output-1.png){width=829 height=516}\n:::\n:::\n\n\n---\n\n### 2.5 Geom√©trica (`geom`)\n\nEn `scipy.stats.geom`, el soporte empieza en 1, pero es com√∫n graficar desde 0 para ver que `P(X=0)=0`.\n\n::: {#f358278b .cell execution_count=15}\n``` {.python .cell-code}\nx = np.linspace(0, 15, num=16)\nxg = np.linspace(-0.5, 15, num=1500)\n\np = 0.4\n\nfx = stats.geom.pmf(x, p)\nFx = stats.geom.cdf(x, p)\nFxg = stats.geom.cdf(xg, p)\n\ntabla_dist = pd.DataFrame({\"x\": x, \"PMF\": fx, \"CDF\": Fx})\ntabla_dist.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=15}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>x</th>\n      <th>PMF</th>\n      <th>CDF</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.0</td>\n      <td>0.0000</td>\n      <td>0.0000</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1.0</td>\n      <td>0.4000</td>\n      <td>0.4000</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2.0</td>\n      <td>0.2400</td>\n      <td>0.6400</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>3.0</td>\n      <td>0.1440</td>\n      <td>0.7840</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>4.0</td>\n      <td>0.0864</td>\n      <td>0.8704</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#5156ce8c .cell execution_count=16}\n``` {.python .cell-code}\nplt.bar(x, fx, color=\"0.6\", edgecolor=\"black\")\nplt.title(f\"PMF ‚Äî Geom√©trica: X ~ Ge({p})\")\nplt.xlabel(\"x\")\nplt.ylabel(\"f(x)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-17-output-1.png){width=842 height=516}\n:::\n:::\n\n\n::: {#3c9e6f8b .cell execution_count=17}\n``` {.python .cell-code}\nplt.step(xg, Fxg, color=\"black\")\nplt.title(f\"CDF ‚Äî Geom√©trica: X ~ Ge({p})\")\nplt.xlabel(\"x\")\nplt.ylabel(\"F(x)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-18-output-1.png){width=829 height=516}\n:::\n:::\n\n\n---\n\n### 2.6 Binomial negativa (`nbinom`)\n\n::: {#b362cbc9 .cell execution_count=18}\n``` {.python .cell-code}\nx = np.linspace(0, 20, num=21)\nxg = np.linspace(-0.5, 20, num=2000)\n\np = 0.4\nr = 3\n\nfx = stats.nbinom.pmf(x, r, p)\nFx = stats.nbinom.cdf(x, r, p)\nFxg = stats.nbinom.cdf(xg, r, p)\n\ntabla_dist = pd.DataFrame({\"x\": x, \"PMF\": fx, \"CDF\": Fx})\ntabla_dist.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=18}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>x</th>\n      <th>PMF</th>\n      <th>CDF</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.0</td>\n      <td>0.064000</td>\n      <td>0.064000</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1.0</td>\n      <td>0.115200</td>\n      <td>0.179200</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2.0</td>\n      <td>0.138240</td>\n      <td>0.317440</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>3.0</td>\n      <td>0.138240</td>\n      <td>0.455680</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>4.0</td>\n      <td>0.124416</td>\n      <td>0.580096</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#e41f0ab4 .cell execution_count=19}\n``` {.python .cell-code}\nplt.bar(x, fx, color=\"0.6\", edgecolor=\"black\")\nplt.title(f\"PMF ‚Äî Binomial negativa: X ~ BN({r},{p})\")\nplt.xlabel(\"x\")\nplt.ylabel(\"f(x)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-20-output-1.png){width=840 height=516}\n:::\n:::\n\n\n::: {#d5cfa708 .cell execution_count=20}\n``` {.python .cell-code}\nplt.step(xg, Fxg, color=\"black\")\nplt.title(f\"CDF ‚Äî Binomial negativa: X ~ BN({r},{p})\")\nplt.xlabel(\"x\")\nplt.ylabel(\"F(x)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-21-output-1.png){width=829 height=516}\n:::\n:::\n\n\n---\n\n### 2.7 Hipergeom√©trica (`hypergeom`)\n\n::: {#3e616fb6 .cell execution_count=21}\n``` {.python .cell-code}\nx = np.linspace(0, 20, num=21)\nxg = np.linspace(0, 20, num=21)\n\nN = 100  # poblaci√≥n\nm = 80   # √©xitos en la poblaci√≥n\nn = 20   # muestra\n\nfx = stats.hypergeom.pmf(x, N, m, n)\nFx = stats.hypergeom.cdf(x, N, m, n)\nFxg = stats.hypergeom.cdf(xg, N, m, n)\n\ntabla_dist = pd.DataFrame({\"x\": x, \"PMF\": fx, \"CDF\": Fx})\ntabla_dist.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=21}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>x</th>\n      <th>PMF</th>\n      <th>CDF</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.0</td>\n      <td>1.865730e-21</td>\n      <td>1.865730e-21</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1.0</td>\n      <td>2.985167e-18</td>\n      <td>2.987033e-18</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2.0</td>\n      <td>1.120184e-15</td>\n      <td>1.123171e-15</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>3.0</td>\n      <td>1.747487e-13</td>\n      <td>1.758719e-13</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>4.0</td>\n      <td>1.429663e-11</td>\n      <td>1.447250e-11</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#5fee5b1b .cell execution_count=22}\n``` {.python .cell-code}\nplt.bar(x, fx, color=\"0.6\", edgecolor=\"black\")\nplt.title(f\"PMF ‚Äî Hipergeom√©trica: X ~ H({N},{m},{n})\")\nplt.xlabel(\"x\")\nplt.ylabel(\"f(x)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-23-output-1.png){width=840 height=517}\n:::\n:::\n\n\n::: {#1141a11e .cell execution_count=23}\n``` {.python .cell-code}\nplt.step(xg, Fxg, color=\"black\")\nplt.title(f\"CDF ‚Äî Hipergeom√©trica: X ~ H({N},{m},{n})\")\nplt.xlabel(\"x\")\nplt.ylabel(\"F(x)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-24-output-1.png){width=829 height=517}\n:::\n:::\n\n\n---\n\n## 3. Distribuciones continuas\n\n### 3.1 Uniforme continua (`uniform`)\n\n::: {#d84c6406 .cell execution_count=24}\n``` {.python .cell-code}\nx = np.linspace(-4, 4, num=200)\nxt = np.linspace(-4, 4, num=9)\n\nalpha = -3\nbeta = 3\n\nfx = stats.uniform.pdf(x, alpha, beta - alpha)\nFx = stats.uniform.cdf(x, alpha, beta - alpha)\nFxt = stats.uniform.cdf(xt, alpha, beta - alpha)\n\ntabla_dist = pd.DataFrame({\"x\": xt, \"CDF\": Fxt})\ntabla_dist\n```\n\n::: {.cell-output .cell-output-display execution_count=24}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>x</th>\n      <th>CDF</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>-4.0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>-3.0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>-2.0</td>\n      <td>0.166667</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>-1.0</td>\n      <td>0.333333</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>0.0</td>\n      <td>0.500000</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>1.0</td>\n      <td>0.666667</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>2.0</td>\n      <td>0.833333</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>3.0</td>\n      <td>1.000000</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>4.0</td>\n      <td>1.000000</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {.callout-note}\n### Sintaxis clave (uniform)\n\nEn `scipy`:\n\n- `loc = alpha`\n- `scale = beta - alpha`\n:::\n\n::: {#b5bc1b63 .cell execution_count=25}\n``` {.python .cell-code}\nplt.plot(x, fx, linestyle=\"-\", color=\"black\")\nplt.title(f\"PDF ‚Äî Uniforme continua: X ~ U({alpha},{beta})\")\nplt.xlabel(\"x\")\nplt.ylabel(\"f(x)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-26-output-1.png){width=850 height=516}\n:::\n:::\n\n\n::: {#1353b62c .cell execution_count=26}\n``` {.python .cell-code}\nplt.plot(x, Fx, linestyle=\"-\", color=\"black\")\nplt.title(f\"CDF ‚Äî Uniforme continua: X ~ U({alpha},{beta})\")\nplt.xlabel(\"x\")\nplt.ylabel(\"F(x)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-27-output-1.png){width=829 height=516}\n:::\n:::\n\n\nCuantiles (ejemplo): intervalo central 95%.\n\n::: {#269fc43c .cell execution_count=27}\n``` {.python .cell-code}\nq025 = stats.uniform.ppf(0.025, alpha, beta - alpha)\nq975 = stats.uniform.ppf(0.975, alpha, beta - alpha)\nq025, q975\n```\n\n::: {.cell-output .cell-output-display execution_count=27}\n```\n(np.float64(-2.85), np.float64(2.8499999999999996))\n```\n:::\n:::\n\n\n---\n\n### 3.2 Normal (`norm`)\n\n::: {#276297ba .cell execution_count=28}\n``` {.python .cell-code}\nx = np.linspace(-5, 15, num=100)\nxt = np.linspace(-5, 15, num=11)\n\nmu = 5\nsigma = 2\n\nfx = stats.norm.pdf(x, mu, sigma)\nFx = stats.norm.cdf(x, mu, sigma)\nFxt = stats.norm.cdf(xt, mu, sigma)\n\ntabla_dist = pd.DataFrame({\"x\": xt, \"CDF\": Fxt})\ntabla_dist\n```\n\n::: {.cell-output .cell-output-display execution_count=28}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>x</th>\n      <th>CDF</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>-5.0</td>\n      <td>2.866516e-07</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>-3.0</td>\n      <td>3.167124e-05</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>-1.0</td>\n      <td>1.349898e-03</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1.0</td>\n      <td>2.275013e-02</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>3.0</td>\n      <td>1.586553e-01</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>5.0</td>\n      <td>5.000000e-01</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>7.0</td>\n      <td>8.413447e-01</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>9.0</td>\n      <td>9.772499e-01</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>11.0</td>\n      <td>9.986501e-01</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>13.0</td>\n      <td>9.999683e-01</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>15.0</td>\n      <td>9.999997e-01</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#aa61c051 .cell execution_count=29}\n``` {.python .cell-code}\nplt.plot(x, fx, linestyle=\"-\", color=\"black\")\nplt.title(f\"PDF ‚Äî Normal: X ~ N({mu},{sigma})\")\nplt.xlabel(\"x\")\nplt.ylabel(\"f(x)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-30-output-1.png){width=850 height=516}\n:::\n:::\n\n\n::: {#51e774de .cell execution_count=30}\n``` {.python .cell-code}\nplt.plot(x, Fx, linestyle=\"-\", color=\"black\")\nplt.title(f\"CDF ‚Äî Normal: X ~ N({mu},{sigma})\")\nplt.xlabel(\"x\")\nplt.ylabel(\"F(x)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-31-output-1.png){width=829 height=516}\n:::\n:::\n\n\nCuantiles (intervalo central 95%):\n\n::: {#1cc9ef15 .cell execution_count=31}\n``` {.python .cell-code}\nq025 = stats.norm.ppf(0.025, mu, sigma)\nq975 = stats.norm.ppf(0.975, mu, sigma)\nq025, q975\n```\n\n::: {.cell-output .cell-output-display execution_count=31}\n```\n(np.float64(1.080072030919891), np.float64(8.919927969080108))\n```\n:::\n:::\n\n\nEjemplo de probabilidad: si `X ~ N(4, 9)`, calcula `P(2 < X ‚â§ 6)`.\n\n::: {#06509de2 .cell execution_count=32}\n``` {.python .cell-code}\nstats.norm.cdf(6, 4, 3) - stats.norm.cdf(2, 4, 3)\n```\n\n::: {.cell-output .cell-output-display execution_count=32}\n```\nnp.float64(0.4950149249061542)\n```\n:::\n:::\n\n\n---\n\n### 3.3 Normal est√°ndar: estandarizaci√≥n\n\nAqu√≠ hacemos dos cosas:\n\n1) estandarizar valores: `z = (x - mu)/sigma`  \n2) usar la normal est√°ndar `N(0,1)`.\n\n::: {#2eeb7c04 .cell execution_count=33}\n``` {.python .cell-code}\nx = np.linspace(-5, 15, num=100)\nxt = np.linspace(-5, 15, num=11)\n\nmu = 5\nsigma = 2\n\nz = (x - mu) / sigma\nzt = (xt - mu) / sigma\n\nfz = stats.norm.pdf(z)\nFz = stats.norm.cdf(z)\nFzt = stats.norm.cdf(zt)\n\ntabla_dist = pd.DataFrame({\"z\": zt, \"CDF\": Fzt})\ntabla_dist\n```\n\n::: {.cell-output .cell-output-display execution_count=33}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>z</th>\n      <th>CDF</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>-5.0</td>\n      <td>2.866516e-07</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>-4.0</td>\n      <td>3.167124e-05</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>-3.0</td>\n      <td>1.349898e-03</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>-2.0</td>\n      <td>2.275013e-02</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>-1.0</td>\n      <td>1.586553e-01</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>0.0</td>\n      <td>5.000000e-01</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>1.0</td>\n      <td>8.413447e-01</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>2.0</td>\n      <td>9.772499e-01</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>3.0</td>\n      <td>9.986501e-01</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>4.0</td>\n      <td>9.999683e-01</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>5.0</td>\n      <td>9.999997e-01</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#04e38cf9 .cell execution_count=34}\n``` {.python .cell-code}\nplt.plot(z, fz, linestyle=\"-\", color=\"black\")\nplt.title(\"PDF ‚Äî Normal est√°ndar: Z ~ N(0,1)\")\nplt.xlabel(\"z\")\nplt.ylabel(\"œÜ(z)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-35-output-1.png){width=840 height=516}\n:::\n:::\n\n\n::: {#71693c48 .cell execution_count=35}\n``` {.python .cell-code}\nplt.plot(z, Fz, linestyle=\"-\", color=\"black\")\nplt.title(\"CDF ‚Äî Normal est√°ndar: Z ~ N(0,1)\")\nplt.xlabel(\"z\")\nplt.ylabel(\"Œ¶(z)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-36-output-1.png){width=829 height=516}\n:::\n:::\n\n\nCuantiles de la normal est√°ndar (95% central):\n\n::: {#134ad76f .cell execution_count=36}\n``` {.python .cell-code}\nstats.norm.ppf(0.025), stats.norm.ppf(0.975)\n```\n\n::: {.cell-output .cell-output-display execution_count=36}\n```\n(np.float64(-1.9599639845400545), np.float64(1.959963984540054))\n```\n:::\n:::\n\n\n---\n\n### 3.4 Chi-cuadrado (`chi2`)\n\n::: {#f5da22f9 .cell execution_count=37}\n``` {.python .cell-code}\nw = np.linspace(0, 15, num=100)\nwt = np.linspace(0, 15, num=16)\n\nm = 5\n\nfw = stats.chi2.pdf(w, m)\nFw = stats.chi2.cdf(w, m)\nFwt = stats.chi2.cdf(wt, m)\n\ntabla_dist = pd.DataFrame({\"w\": wt, \"CDF\": Fwt})\ntabla_dist.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=37}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>w</th>\n      <th>CDF</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1.0</td>\n      <td>0.037434</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2.0</td>\n      <td>0.150855</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>3.0</td>\n      <td>0.300014</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>4.0</td>\n      <td>0.450584</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#284f9552 .cell execution_count=38}\n``` {.python .cell-code}\nplt.plot(w, fw, linestyle=\"-\", color=\"black\")\nplt.title(rf\"PDF ‚Äî Chi-cuadrado: W ~ $\\chi^2$({m})\")\nplt.xlabel(\"w\")\nplt.ylabel(\"f(w)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-39-output-1.png){width=840 height=520}\n:::\n:::\n\n\n::: {#e1905730 .cell execution_count=39}\n``` {.python .cell-code}\nplt.plot(w, Fw, linestyle=\"-\", color=\"black\")\nplt.title(rf\"CDF ‚Äî Chi-cuadrado: W ~ $\\chi^2$({m})\")\nplt.xlabel(\"w\")\nplt.ylabel(\"F(w)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-40-output-1.png){width=829 height=520}\n:::\n:::\n\n\nCuantil 0.95:\n\n::: {#5ea95586 .cell execution_count=40}\n``` {.python .cell-code}\nstats.chi2.ppf(0.95, m)\n```\n\n::: {.cell-output .cell-output-display execution_count=40}\n```\nnp.float64(11.070497693516351)\n```\n:::\n:::\n\n\n---\n\n### 3.5 t de Student (`t`)\n\n::: {#2e886644 .cell execution_count=41}\n``` {.python .cell-code}\nv = np.linspace(-5, 5, num=100)\nvt = np.linspace(-5, 5, num=11)\n\nm = 5\n\nfv = stats.t.pdf(v, m)\nFv = stats.t.cdf(v, m)\nFvt = stats.t.cdf(vt, m)\n\ntabla_dist = pd.DataFrame({\"v\": vt, \"CDF\": Fvt})\ntabla_dist\n```\n\n::: {.cell-output .cell-output-display execution_count=41}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>v</th>\n      <th>CDF</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>-5.0</td>\n      <td>0.002052</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>-4.0</td>\n      <td>0.005162</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>-3.0</td>\n      <td>0.015050</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>-2.0</td>\n      <td>0.050970</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>-1.0</td>\n      <td>0.181609</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>0.0</td>\n      <td>0.500000</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>1.0</td>\n      <td>0.818391</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>2.0</td>\n      <td>0.949030</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>3.0</td>\n      <td>0.984950</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>4.0</td>\n      <td>0.994838</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>5.0</td>\n      <td>0.997948</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#bf63b03d .cell execution_count=42}\n``` {.python .cell-code}\nplt.plot(v, fv, linestyle=\"-\", color=\"black\")\nplt.title(f\"PDF ‚Äî t de Student: V ~ t({m})\")\nplt.xlabel(\"v\")\nplt.ylabel(\"f(v)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-43-output-1.png){width=840 height=516}\n:::\n:::\n\n\n::: {#dbd796fa .cell execution_count=43}\n``` {.python .cell-code}\nplt.plot(v, Fv, linestyle=\"-\", color=\"black\")\nplt.title(f\"CDF ‚Äî t de Student: V ~ t({m})\")\nplt.xlabel(\"v\")\nplt.ylabel(\"F(v)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-44-output-1.png){width=829 height=516}\n:::\n:::\n\n\nCuantiles 0.025 y 0.975:\n\n::: {#1f8a9b1d .cell execution_count=44}\n``` {.python .cell-code}\nstats.t.ppf(0.025, m), stats.t.ppf(0.975, m)\n```\n\n::: {.cell-output .cell-output-display execution_count=44}\n```\n(np.float64(-2.5705818356363146), np.float64(2.570581835636314))\n```\n:::\n:::\n\n\n---\n\n### 3.6 F de Fisher (`f`)\n\n::: {#bddc511c .cell execution_count=45}\n``` {.python .cell-code}\nr = np.linspace(0, 15, num=100)\nrt = np.linspace(0, 15, num=16)\n\nm1 = 5\nm2 = 3\n\nfr = stats.f.pdf(r, m1, m2)\nFr = stats.f.cdf(r, m1, m2)\nFrt = stats.f.cdf(rt, m1, m2)\n\ntabla_dist = pd.DataFrame({\"r\": rt, \"CDF\": Frt})\ntabla_dist.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=45}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>r</th>\n      <th>CDF</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.0</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1.0</td>\n      <td>0.464855</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2.0</td>\n      <td>0.698453</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>3.0</td>\n      <td>0.802577</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>4.0</td>\n      <td>0.858387</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#04a06fb2 .cell execution_count=46}\n``` {.python .cell-code}\nplt.plot(r, fr, linestyle=\"-\", color=\"black\")\nplt.title(rf\"PDF ‚Äî F: R ~ F({m1},{m2})\")\nplt.xlabel(\"r\")\nplt.ylabel(\"f(r)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-47-output-1.png){width=829 height=516}\n:::\n:::\n\n\n::: {#51ee7e96 .cell execution_count=47}\n``` {.python .cell-code}\nplt.plot(r, Fr, linestyle=\"-\", color=\"black\")\nplt.title(rf\"CDF ‚Äî F: R ~ F({m1},{m2})\")\nplt.xlabel(\"r\")\nplt.ylabel(\"F(r)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-48-output-1.png){width=829 height=516}\n:::\n:::\n\n\nCuantil 0.95:\n\n::: {#867575df .cell execution_count=48}\n``` {.python .cell-code}\nstats.f.ppf(0.95, m1, m2)\n```\n\n::: {.cell-output .cell-output-display execution_count=48}\n```\nnp.float64(9.013455167522583)\n```\n:::\n:::\n\n\n---\n\n### 3.7 Exponencial (`expon`)\n\n::: {#50c85f21 .cell execution_count=49}\n``` {.python .cell-code}\nx = np.linspace(-0.5, 6, num=150)\nxt = np.linspace(-0.5, 6, num=9)\n\nplambda = 1\n\nfx = stats.expon.pdf(x, scale=1 / plambda)\nFx = stats.expon.cdf(x, scale=1 / plambda)\nFxt = stats.expon.cdf(xt, scale=1 / plambda)\n\ntabla_dist = pd.DataFrame({\"x\": xt, \"CDF\": Fxt})\ntabla_dist\n```\n\n::: {.cell-output .cell-output-display execution_count=49}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>x</th>\n      <th>CDF</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>-0.5000</td>\n      <td>0.000000</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0.3125</td>\n      <td>0.268384</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1.1250</td>\n      <td>0.675348</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1.9375</td>\n      <td>0.855936</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2.7500</td>\n      <td>0.936072</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>3.5625</td>\n      <td>0.971632</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>4.3750</td>\n      <td>0.987412</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>5.1875</td>\n      <td>0.994414</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>6.0000</td>\n      <td>0.997521</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {.callout-note}\n### Sintaxis clave (expon)\n\nSi t√∫ trabajas con tasa `Œª`, en `scipy` se usa:\n\n- `scale = 1/Œª`\n:::\n\n::: {#6cb18b07 .cell execution_count=50}\n``` {.python .cell-code}\nplt.plot(x, fx, linestyle=\"-\", color=\"black\")\nplt.title(f\"PDF ‚Äî Exponencial: X ~ Exp({plambda})\")\nplt.xlabel(\"x\")\nplt.ylabel(\"f(x)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-51-output-1.png){width=829 height=516}\n:::\n:::\n\n\n::: {#9cded8ac .cell execution_count=51}\n``` {.python .cell-code}\nplt.plot(x, Fx, linestyle=\"-\", color=\"black\")\nplt.title(f\"CDF ‚Äî Exponencial: X ~ Exp({plambda})\")\nplt.xlabel(\"x\")\nplt.ylabel(\"F(x)\")\nplt.grid(alpha=0.4)\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-52-output-1.png){width=829 height=516}\n:::\n:::\n\n\nCuantil 0.95:\n\n::: {#d88aa676 .cell execution_count=52}\n``` {.python .cell-code}\nstats.expon.ppf(0.95, scale=1 / plambda)\n```\n\n::: {.cell-output .cell-output-display execution_count=52}\n```\nnp.float64(2.99573227355399)\n```\n:::\n:::\n\n\n---\n\n## 4. Simulaci√≥n (muestra vs teor√≠a)\n\nLa simulaci√≥n tiene dos ideas √∫tiles:\n\n1) comparar ‚Äúlo que sali√≥‚Äù (frecuencia/histograma) con ‚Äúla teor√≠a‚Äù (PMF/PDF),  \n2) ver c√≥mo el **promedio acumulado** converge a la esperanza te√≥rica.\n\n---\n\n### 4.1 Bernoulli simulada\n\n::: {#bc29cdde .cell execution_count=53}\n``` {.python .cell-code}\nsemilla = None  # None -> resultados diferentes cada ejecuci√≥n\nns = 1000\np = 0.5\n\nmuestra = stats.bernoulli.rvs(p, size=ns, random_state=semilla)\n\n# Frecuencias\nvalores, freq_abs = np.unique(muestra, return_counts=True)\nfreq_rel = freq_abs / ns\n\n# PMF te√≥rica\npmft = stats.bernoulli.pmf(valores, p)\n\n# Comparaci√≥n: muestra vs teor√≠a\nplt.bar(valores - 0.15, freq_rel, width=0.2, color=\"blue\", label=\"Muestra\")\nplt.bar(valores + 0.15, pmft, width=0.2, color=\"red\", label=\"Teor√≠a\")\nfor xx, yy in zip(valores - 0.15, freq_rel):\n    plt.text(xx, yy + 0.005, f\"{yy:.3f}\", ha=\"center\", va=\"bottom\")\nplt.xlabel(\"Valor\")\nplt.ylabel(\"Probabilidad / Frecuencia relativa\")\nplt.grid(alpha=0.4)\nplt.legend(loc=\"upper center\", bbox_to_anchor=(0.5, -0.12))\nplt.title(\"Frecuencia relativa vs PMF te√≥rica\")\nplt.show()\nplt.close()\n\n# Promedio acumulado\ncum_ns = np.arange(1, ns + 1)\nplt.plot(cum_ns, muestra.cumsum() / cum_ns, label=\"Promedio acumulado\")\nplt.axhline(y=p, color=\"red\", label=\"Esperanza te√≥rica\")\nplt.xlabel(\"N√∫mero de simulaciones\")\nplt.ylabel(\"Promedio acumulado de √©xitos (X=1)\")\nplt.grid(alpha=0.4)\nplt.legend(loc=\"upper center\", bbox_to_anchor=(0.5, -0.12))\nplt.title(\"Promedio acumulado vs Esperanza te√≥rica\")\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-54-output-1.png){width=829 height=578}\n:::\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-54-output-2.png){width=829 height=579}\n:::\n:::\n\n\n---\n\n### 4.2 Uniforme discreta simulada\n\n::: {#21bf3a77 .cell execution_count=54}\n``` {.python .cell-code}\nsemilla = None\nns = 1000\na, b = 1, 6\n\nmuestra = stats.randint.rvs(a, b + 1, size=ns, random_state=semilla)\n\nvalores, freq_abs = np.unique(muestra, return_counts=True)\nfreq_rel = freq_abs / ns\n\npmft = stats.randint.pmf(valores, a, b + 1)\n\nplt.bar(valores - 0.15, freq_rel, width=0.2, color=\"blue\", label=\"Muestra\")\nplt.bar(valores + 0.15, pmft, width=0.2, color=\"red\", label=\"Teor√≠a\")\nfor xx, yy in zip(valores - 0.15, freq_rel):\n    plt.text(xx, yy + 0.005, f\"{yy:.3f}\", ha=\"center\", va=\"bottom\")\nplt.xlabel(\"Valor\")\nplt.ylabel(\"Probabilidad / Frecuencia relativa\")\nplt.grid(alpha=0.4)\nplt.legend(loc=\"upper center\", bbox_to_anchor=(0.5, -0.12))\nplt.title(\"Frecuencia relativa vs PMF te√≥rica\")\nplt.show()\nplt.close()\n\ncum_ns = np.arange(1, ns + 1)\nplt.plot(cum_ns, muestra.cumsum() / cum_ns, label=\"Promedio acumulado\")\nplt.axhline(y=(a + b) / 2, color=\"red\", label=\"Esperanza te√≥rica\")\nplt.xlabel(\"N√∫mero de simulaciones\")\nplt.ylabel(\"Promedio acumulado de valores de X\")\nplt.grid(alpha=0.4)\nplt.legend(loc=\"upper center\", bbox_to_anchor=(0.5, -0.12))\nplt.title(\"Promedio acumulado vs Esperanza te√≥rica\")\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-55-output-1.png){width=850 height=578}\n:::\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-55-output-2.png){width=829 height=579}\n:::\n:::\n\n\n---\n\n### 4.3 Normal simulada\n\n::: {#2095b293 .cell execution_count=55}\n``` {.python .cell-code}\nsemilla = None\nns = 1000\nmu, sigma = 0, 1\n\nmuestra = stats.norm.rvs(mu, sigma, size=ns, random_state=semilla)\n\nlim = max(abs(muestra.min()), abs(muestra.max()))\nx = np.linspace(-lim, lim, num=100)\npdft = stats.norm.pdf(x, mu, sigma)\n\nplt.hist(muestra, bins=10, density=True, edgecolor=\"black\", color=\"blue\", alpha=0.5, label=\"Muestra\")\nplt.plot(x, pdft, color=\"red\", linewidth=3, label=\"Teor√≠a\")\nplt.xlabel(\"X\")\nplt.ylabel(\"Densidad\")\nplt.grid(alpha=0.4)\nplt.legend(loc=\"upper center\", bbox_to_anchor=(0.5, -0.12))\nplt.title(\"Histograma vs PDF te√≥rica\")\nplt.show()\nplt.close()\n\ncum_ns = np.arange(1, ns + 1)\nplt.plot(cum_ns, muestra.cumsum() / cum_ns, label=\"Promedio acumulado\")\nplt.axhline(y=mu, color=\"red\", label=\"Esperanza te√≥rica\")\nplt.xlabel(\"N√∫mero de simulaciones\")\nplt.ylabel(\"Promedio acumulado de valores de X\")\nplt.grid(alpha=0.4)\nplt.legend(loc=\"upper center\", bbox_to_anchor=(0.5, -0.12))\nplt.title(\"Promedio acumulado vs Esperanza te√≥rica\")\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-56-output-1.png){width=840 height=579}\n:::\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-56-output-2.png){width=829 height=579}\n:::\n:::\n\n\n---\n\n### 4.4 Chi-cuadrado simulada (por partes)\n\nLa chi-cuadrado puede verse como suma de cuadrados de normales est√°ndar.\n\n::: {#62470924 .cell execution_count=56}\n``` {.python .cell-code}\nsemilla = None\nns = 1000\nm = 5\n\nsim_partes = True\nif sim_partes:\n    sim_var2 = []\n    for i in range(1, m + 1):\n        semilla2 = None if semilla is None else semilla + i\n        sim_var = stats.norm.rvs(size=ns, random_state=semilla2)  # Z ~ N(0,1)\n        sim_var2.append(sim_var**2)\n    muestra = sum(sim_var2)\nelse:\n    muestra = stats.chi2.rvs(m, size=ns, random_state=semilla)\n\n# PDF te√≥rica\nlim = max(abs(muestra.min()), abs(muestra.max()))\nx = np.linspace(0, lim, num=200)\npdft = stats.chi2.pdf(x, m)\n\nplt.hist(muestra, bins=12, density=True, edgecolor=\"black\", color=\"blue\", alpha=0.5, label=\"Muestra\")\nplt.plot(x, pdft, color=\"red\", linewidth=3, label=\"Teor√≠a\")\nplt.xlabel(\"X\")\nplt.ylabel(\"Densidad\")\nplt.grid(alpha=0.4)\nplt.legend(loc=\"upper center\", bbox_to_anchor=(0.5, -0.12))\nplt.title(\"Histograma vs PDF te√≥rica\")\nplt.show()\nplt.close()\n\ncum_ns = np.arange(1, ns + 1)\nplt.plot(cum_ns, muestra.cumsum() / cum_ns, label=\"Promedio acumulado\")\nplt.axhline(y=m, color=\"red\", label=\"Esperanza te√≥rica\")\nplt.xlabel(\"N√∫mero de simulaciones\")\nplt.ylabel(\"Promedio acumulado de valores de X\")\nplt.grid(alpha=0.4)\nplt.legend(loc=\"upper center\", bbox_to_anchor=(0.5, -0.12))\nplt.title(\"Promedio acumulado vs Esperanza te√≥rica\")\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-57-output-1.png){width=840 height=579}\n:::\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-57-output-2.png){width=840 height=579}\n:::\n:::\n\n\n---\n\n### 4.5 t de Student simulada (por construcci√≥n)\n\nUna forma de construir una t es: `Z / sqrt(W/m)` con `Z ~ N(0,1)` y `W ~ chi^2(m)` independientes.\n\n::: {#62a34c0b .cell execution_count=57}\n``` {.python .cell-code}\nsemilla = None\nns = 1000\nm = 5\n\nsim_partes = True\nif sim_partes:\n    semilla2 = None if semilla is None else semilla + 1\n    sim_var_Z = stats.norm.rvs(size=ns, random_state=semilla)\n    sim_var_W = stats.chi2.rvs(m, size=ns, random_state=semilla2)\n    muestra = sim_var_Z / np.sqrt(sim_var_W / m)\nelse:\n    muestra = stats.t.rvs(m, size=ns, random_state=semilla)\n\n# PDF te√≥rica\nlim = max(abs(muestra.min()), abs(muestra.max()))\nx = np.linspace(-lim, lim, num=200)\npdft = stats.t.pdf(x, m)\n\nplt.hist(muestra, bins=20, density=True, edgecolor=\"black\", color=\"blue\", alpha=0.5, label=\"Muestra\")\nplt.plot(x, pdft, color=\"red\", linewidth=3, label=\"Teor√≠a\")\nplt.xlabel(\"X\")\nplt.ylabel(\"Densidad\")\nplt.grid(alpha=0.4)\nplt.legend(loc=\"upper center\", bbox_to_anchor=(0.5, -0.12))\nplt.title(\"Histograma vs PDF te√≥rica\")\nplt.show()\nplt.close()\n\ncum_ns = np.arange(1, ns + 1)\nplt.plot(cum_ns, muestra.cumsum() / cum_ns, label=\"Promedio acumulado\")\nplt.axhline(y=0, color=\"red\", label=\"Esperanza te√≥rica\")\nplt.xlabel(\"N√∫mero de simulaciones\")\nplt.ylabel(\"Promedio acumulado de valores de X\")\nplt.grid(alpha=0.4)\nplt.legend(loc=\"upper center\", bbox_to_anchor=(0.5, -0.12))\nplt.title(\"Promedio acumulado vs Esperanza te√≥rica\")\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-58-output-1.png){width=840 height=579}\n:::\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-58-output-2.png){width=829 height=579}\n:::\n:::\n\n\n---\n\n### 4.6 F de Fisher simulada (por construcci√≥n)\n\nConstrucci√≥n t√≠pica:\n\n\\[\nR = (W_1/m_1) / (W_2/m_2),\n\\]\ndonde `W1 ~ chi^2(m1)` y `W2 ~ chi^2(m2)` independientes.\n\n::: {#a926f819 .cell execution_count=58}\n``` {.python .cell-code}\nsemilla = None\nns = 1000\nm1, m2 = 5, 3\n\nsim_partes = True\nif sim_partes:\n    semilla2 = None if semilla is None else semilla + 1\n    sim_var_W1 = stats.chi2.rvs(m1, size=ns, random_state=semilla)\n    sim_var_W2 = stats.chi2.rvs(m2, size=ns, random_state=semilla2)\n    muestra = (sim_var_W1 / m1) / (sim_var_W2 / m2)\nelse:\n    muestra = stats.f.rvs(m1, m2, size=ns, random_state=semilla)\n\n# PDF te√≥rica\nlim = np.quantile(muestra, 0.99)  # evita que un extremo gigante \"rompa\" la gr√°fica\nx = np.linspace(0, lim, num=200)\npdft = stats.f.pdf(x, m1, m2)\n\nplt.hist(muestra, bins=30, density=True, edgecolor=\"black\", color=\"blue\", alpha=0.5, label=\"Muestra\")\nplt.plot(x, pdft, color=\"red\", linewidth=3, label=\"Teor√≠a\")\nplt.xlabel(\"X\")\nplt.ylabel(\"Densidad\")\nplt.grid(alpha=0.4)\nplt.legend(loc=\"upper center\", bbox_to_anchor=(0.5, -0.12))\nplt.title(\"Histograma vs PDF te√≥rica\")\nplt.show()\nplt.close()\n\ncum_ns = np.arange(1, ns + 1)\nplt.plot(cum_ns, muestra.cumsum() / cum_ns, label=\"Promedio acumulado\")\nplt.axhline(y=m2 / (m2 - 2), color=\"red\", label=\"Esperanza te√≥rica\")\nplt.xlabel(\"N√∫mero de simulaciones\")\nplt.ylabel(\"Promedio acumulado de valores de X\")\nplt.grid(alpha=0.4)\nplt.legend(loc=\"upper center\", bbox_to_anchor=(0.5, -0.12))\nplt.title(\"Promedio acumulado vs Esperanza te√≥rica\")\nplt.show()\nplt.close()\n```\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-59-output-1.png){width=829 height=579}\n:::\n\n::: {.cell-output .cell-output-display}\n![](06-distribuciones-de-probabilidad_files/figure-html/cell-59-output-2.png){width=829 height=579}\n:::\n:::\n\n\n---\n\n## Ejercicios propuestos\n\n1) **Binomial (PMF y CDF)**  \n   Para `X ~ Bn(10, 0.2)`, calcula `P(X=2)` y `P(X‚â§2)`.\n\n   **Respuesta esperada:** dos n√∫meros en (0, 1).\n\n2) **Cuantiles (normal)**  \n   Para `X ~ N(5,2)`, calcula el intervalo central del 95% usando `ppf(0.025)` y `ppf(0.975)`.\n\n   **Respuesta esperada:** dos valores (l√≠mite inferior y superior).\n\n3) **Normal est√°ndar**  \n   Estandariza `x=9` si `X ~ N(5,2)` y calcula `P(X‚â§9)` usando `Œ¶(z)` (CDF est√°ndar).\n\n   **Respuesta esperada:** un valor cercano a `0.977` (aprox.).\n\n4) **Simulaci√≥n Bernoulli**  \n   Simula `ns=5000` con `p=0.3` y grafica el promedio acumulado.\n\n   **Respuesta esperada:** el promedio acumulado se acerca a `0.3`.\n\n5) **Exponencial**  \n   Con `Œª=1`, calcula el cuantil 0.95 con `ppf`.\n\n   **Respuesta esperada:** un valor cercano a `‚âà 3`.\n\n6) **F de Fisher**  \n   Para `F(5,3)`, calcula el cuantil 0.95.\n\n   **Respuesta esperada:** un n√∫mero positivo mayor que 1.\n\n---\n\n::: {.content-visible when-format=\"pdf\"}\n## Glosario (para Colab)\n\n- **PMF/PDF/CDF**: masa / densidad / acumulada.\n- **PPF**: cuantil (inversa de la CDF).\n- **rvs**: simulaci√≥n (muestra aleatoria).\n- **loc/scale**: par√°metros est√°ndar de `scipy`.\n:::\n\n",
    "supporting": [
      "06-distribuciones-de-probabilidad_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js\" integrity=\"sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js\" integrity=\"sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}