---
title: "Cap√≠tulo 5 ‚Äî Estad√≠sticas descriptivas (tablas, gr√°ficos y resumen)"
---

[üöÄ Abrir este cap√≠tulo en Google Colab](https://colab.research.google.com/github/FraRafa/manual/blob/main/notebooks/05-estadisticas-descriptivas.ipynb){.btn .btn-success target="_blank"}

```{python}
#| include: false
# Setup interno (se ejecuta, pero no se muestra en HTML/PDF)
import sys
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

plt.rcParams["figure.figsize"] = (8, 4.5)
plt.rcParams["figure.dpi"] = 120
```

::: {.callout-note}
## Objetivos del cap√≠tulo

Al terminar este cap√≠tulo vas a poder:

- construir **tablas de frecuencia** y **proporciones** con `value_counts`,
- construir **tablas de contingencia** con `pd.crosstab`,
- crear gr√°ficos a partir de tablas: **pastel**, **barras**, **apiladas** y **agrupadas**,
- visualizar distribuciones num√©ricas: **histograma**, **densidad** (opcional) y **boxplot**,
- construir una **ECDF** (funci√≥n de distribuci√≥n acumulada emp√≠rica),
- calcular estad√≠sticos: `mean`, `median`, `var`, `std`, `cov`, `corr` y `describe`.
:::

---

## 1. Qu√© haremos (enfocado en Python)

Este cap√≠tulo no es para ‚Äúexplicar estad√≠stica‚Äù. T√∫ ya la sabes.  
Aqu√≠ nos enfocamos en **c√≥mo** se hacen estos res√∫menes con Python.

::: {.column-margin}
<details>
<summary><strong>Glosario</strong></summary>

- **frecuencia**: cu√°ntas veces aparece un valor.
- **proporci√≥n**: frecuencia / total.
- **crosstab**: tabla cruzada (contingencia).
- **densidad**: histograma escalado para que el √°rea sea 1 (`density=True`).
- **KDE**: estimaci√≥n de densidad (Kernel Density Estimation).
- **boxplot**: gr√°fico de caja y bigotes.
- **cov / corr**: covarianza / correlaci√≥n.
</details>
:::

---

## 2. Datos de ejemplo (local)

En el notebook base se usan bases reales (`wooldridge`).  
En el manual usamos datos peque√±os **locales** para aprender la sintaxis sin depender de internet.

```{python}
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

np.random.seed(123)

df = pd.DataFrame({
    "marriage": np.random.choice(["mala", "regular", "buena"], size=80, p=[0.2, 0.35, 0.45]),
    "haskids":  np.random.choice(["sin hijos", "con hijos"], size=80, p=[0.55, 0.45]),
    "roe":      np.clip(np.random.normal(loc=12, scale=6, size=80), -10, 40),
    "salary":   np.clip(np.random.normal(loc=120, scale=35, size=80), 20, 300)
})
df.head()
```

---

## 3. Distribuciones discretas: tablas de frecuencia

### 3.1 Tabla de frecuencia (conteos)

```{python}
freq = df["marriage"].value_counts()
freq
```

Proporciones (porcentaje):

```{python}
prop = df["marriage"].value_counts(normalize=True) * 100
prop
```

::: {.callout-note}
### Sintaxis clave (`value_counts`)

- `serie.value_counts()` ‚Üí conteos.
- `serie.value_counts(normalize=True)` ‚Üí proporciones (suman 1).
:::

---

### 3.2 Gr√°fico de pastel (desde frecuencias)

```{python}
freq.plot(kind="pie", autopct="%1.1f%%")
plt.ylabel("")  # quita etiqueta fea del eje y en pastel
plt.title("marriage ‚Äî gr√°fico de pastel")
plt.show()
```

---

### 3.3 Barras (horizontal)

```{python}
freq.sort_values().plot(kind="barh")
plt.title("marriage ‚Äî barras (frecuencia)")
plt.xlabel("frecuencia")
plt.ylabel("categor√≠a")
plt.show()
```

---

### 3.4 Frecuencia por subgrupos (segmentaci√≥n)

Ejemplo: ¬øc√≥mo se distribuye `marriage` entre ‚Äúcon hijos‚Äù y ‚Äúsin hijos‚Äù?

```{python}
tabla_sub = pd.crosstab(df["marriage"], df["haskids"])
tabla_sub
```

#### Barras apiladas

```{python}
tabla_sub.plot(kind="bar", stacked=True)
plt.title("marriage vs haskids ‚Äî barras apiladas")
plt.xlabel("marriage")
plt.ylabel("frecuencia")
plt.show()
```

#### Barras agrupadas

```{python}
tabla_sub.plot(kind="bar", stacked=False)
plt.title("marriage vs haskids ‚Äî barras agrupadas")
plt.xlabel("marriage")
plt.ylabel("frecuencia")
plt.show()
```

---

### 3.5 Tabla de contingencia y proporciones

```{python}
pd.crosstab(df["marriage"], df["haskids"])
```

Proporci√≥n del total:

```{python}
pd.crosstab(df["marriage"], df["haskids"], normalize=True)
```

Proporci√≥n por filas:

```{python}
pd.crosstab(df["marriage"], df["haskids"], normalize="index")
```

Proporci√≥n por columnas:

```{python}
pd.crosstab(df["marriage"], df["haskids"], normalize="columns")
```

::: {.callout-note}
### Sintaxis clave (`crosstab`)

- `normalize=True` ‚Üí proporci√≥n del total.
- `normalize="index"` ‚Üí cada fila suma 1.
- `normalize="columns"` ‚Üí cada columna suma 1.
:::

---

## 4. Distribuciones continuas: histogramas y densidades

### 4.1 Histograma (frecuencia)

```{python}
plt.hist(df["roe"], bins=12)
plt.title("Histograma de ROE (frecuencia)")
plt.xlabel("roe")
plt.ylabel("frecuencia")
plt.show()
```

### 4.2 Histograma como densidad

```{python}
plt.hist(df["roe"], bins=12, density=True)
plt.title("Histograma de ROE (densidad)")
plt.xlabel("roe")
plt.ylabel("densidad")
plt.show()
```

::: {.callout-note}
### Sintaxis clave (`density=True`)

- `density=True` cambia la escala: el √°rea total del histograma ‚âà 1.
- √ötil para comparar distribuciones con tama√±os distintos.
:::

---

### 4.3 Densidad KDE (opcional)

En algunos entornos `Series.plot(kind="density")` requiere dependencias (puede fallar).  
Por eso lo dejamos **opcional** y desactivado en Quarto.

```{python}
#| eval: false
df["roe"].plot(kind="density")
plt.title("KDE de ROE (opcional)")
plt.xlabel("roe")
plt.show()
```

---

## 5. ECDF (funci√≥n de distribuci√≥n acumulada emp√≠rica)

```{python}
x = np.sort(df["roe"].to_numpy())
y = np.arange(1, len(x) + 1) / len(x)

plt.plot(x, y)
plt.title("ECDF de ROE")
plt.xlabel("roe (x)")
plt.ylabel("F(x) acumulada")
plt.ylim(0, 1)
plt.show()
```

---

## 6. Estad√≠sticos descriptivos principales

### 6.1 Resumen r√°pido con `describe`

```{python}
df[["roe", "salary"]].describe()
```

### 6.2 Media, mediana, varianza, desviaci√≥n est√°ndar

```{python}
roe_mean = df["roe"].mean()
roe_med  = df["roe"].median()
roe_var  = df["roe"].var()
roe_std  = df["roe"].std()

roe_mean, roe_med, roe_var, roe_std
```

### 6.3 Covarianza y correlaci√≥n

```{python}
df[["salary", "roe"]].cov()
```

```{python}
df[["salary", "roe"]].corr()
```

::: {.callout-note}
### Sintaxis clave (cov/corr)

- `df[cols].cov()` ‚Üí matriz de covarianza.
- `df[cols].corr()` ‚Üí matriz de correlaci√≥n.
:::

---

## 7. Boxplots (gr√°ficos de caja)

```{python}
plt.boxplot(df["roe"].dropna())
plt.title("Boxplot de ROE")
plt.ylabel("roe")
plt.show()
```

Boxplot por grupo (por ejemplo, seg√∫n `haskids`):

```{python}
df.boxplot(column="roe", by="haskids")
plt.title("ROE por haskids (boxplot)")
plt.suptitle("")  # quita t√≠tulo autom√°tico feo
plt.xlabel("haskids")
plt.ylabel("roe")
plt.show()
```

---

## 8. Aplicaci√≥n con datos reales (opcional, online)

Esto replica m√°s fielmente el notebook base, pero depende de instalaci√≥n/internet.  
En Quarto lo dejamos desactivado (`eval: false`). En Colab suele funcionar.

```{python}
#| eval: false
# En VSCode: pip install wooldridge
# En Colab:  !pip -q install wooldridge
import wooldridge as woo
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

affairs = woo.dataWoo("affairs")

# Frecuencias y tablas
affairs["ratemarr"].value_counts()
pd.crosstab(affairs["ratemarr"], affairs["kids"])

# Continuas: ceosal1
ceosal1 = woo.dataWoo("ceosal1")

plt.hist(ceosal1["roe"], bins=20)
plt.title("Histograma de ROE (ceosal1)")
plt.show()

plt.hist(ceosal1["roe"], bins=20, density=True)
plt.title("Histograma de ROE (densidad, ceosal1)")
plt.show()

# ECDF
x = np.sort(ceosal1["roe"].to_numpy())
y = np.arange(1, len(x) + 1) / len(x)
plt.plot(x, y)
plt.title("ECDF de ROE (ceosal1)")
plt.ylim(0, 1)
plt.show()

# Estad√≠sticos y matrices
ceosal1[["salary", "roe"]].describe()
ceosal1[["salary", "roe"]].cov()
ceosal1[["salary", "roe"]].corr()

# Boxplot
ceosal1.boxplot(column="roe")
plt.title("Boxplot de ROE (ceosal1)")
plt.show()
```

---

## Ejercicios propuestos

1) **Frecuencias + gr√°fico**  
   Obt√©n `value_counts()` de `marriage` y genera un gr√°fico de barras horizontal.

   **Respuesta esperada:** 3 barras con los conteos por categor√≠a.

2) **Crosstab + normalizaci√≥n**  
   Crea `pd.crosstab(marriage, haskids, normalize="index")`.

   **Respuesta esperada:** cada fila suma 1.

3) **Histograma (frecuencia vs densidad)**  
   Grafica dos histogramas de `roe`: uno normal y otro con `density=True`.

   **Respuesta esperada:** cambian las escalas del eje y (frecuencia vs densidad).

4) **ECDF + percentil**  
   Construye la ECDF de `roe` y estima el valor que deja 90% por debajo.

   **Respuesta esperada:** un n√∫mero cercano a `df["roe"].quantile(0.9)`.

5) **Cov y Corr**  
   Calcula `cov()` y `corr()` para `salary` y `roe`.

   **Respuesta esperada:** dos matrices 2√ó2 (covarianza y correlaci√≥n).

6) **Boxplot por grupo**  
   Crea un boxplot de `roe` por `haskids`.

   **Respuesta esperada:** 2 cajas (una por cada categor√≠a de `haskids`).

---

::: {.content-visible when-format="pdf"}
## Glosario (para Colab)

- **frecuencia**: conteos.
- **proporci√≥n**: conteos / total.
- **crosstab**: tabla cruzada.
- **densidad**: histograma escalado (`density=True`).
- **KDE**: densidad estimada (kernel).
- **boxplot**: gr√°fico de caja.
- **cov / corr**: covarianza / correlaci√≥n.
:::
