---
title: "Cap√≠tulo 5 ‚Äî Estad√≠sticas descriptivas (tablas, gr√°ficos y resumen)"
---

[üöÄ Abrir este cap√≠tulo en Google Colab](https://colab.research.google.com/github/FraRafa/manual/blob/main/notebooks/05-estadisticas-descriptivas.ipynb){.btn .btn-success target="_blank"}

```{python}
#| include: false
# Setup interno (se ejecuta, pero no se muestra en HTML/PDF)
import sys
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

plt.rcParams["figure.figsize"] = (8, 4.5)
plt.rcParams["figure.dpi"] = 120
```

::: {.callout-note}
## Objetivos del cap√≠tulo

Al terminar este cap√≠tulo vas a poder:

- construir **tablas de frecuencia** y **porcentajes** con `value_counts`,
- crear **tablas de contingencia** con `pd.crosstab` y normalizarlas,
- graficar categor√≠as con **pastel**, **barras**, **apiladas** y **agrupadas**,
- visualizar variables num√©ricas con **histograma** (frecuencia o densidad) y **boxplot**,
- construir una **ECDF** (distribuci√≥n acumulada emp√≠rica) con `numpy`,
- calcular estad√≠sticos y matrices con `describe`, `var`, `std`, `cov`, `corr`.
:::

---

## 1. Qu√© haremos (enfocado en Python)

Este cap√≠tulo no es para ‚Äúexplicar estad√≠stica‚Äù.  
Aqu√≠ nos concentramos en **c√≥mo escribir el c√≥digo** para resumir y visualizar datos.

::: {.column-margin}
<details>
<summary><strong>Glosario</strong></summary>

- **frecuencia**: cu√°ntas veces aparece un valor.
- **proporci√≥n**: frecuencia / total.
- **crosstab**: tabla cruzada (contingencia).
- **densidad**: histograma escalado para que el √°rea total sea 1 (`density=True`).
- **KDE**: estimaci√≥n de densidad (Kernel Density Estimation).
- **boxplot**: gr√°fico de caja y bigotes.
- **cov / corr**: covarianza / correlaci√≥n.
</details>
:::

---

## 2. Datos de ejemplo (local)

Usamos datos peque√±os **locales** para practicar la sintaxis (sin depender de internet).

```{python}
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

np.random.seed(123)

df = pd.DataFrame({
    "marriage": np.random.choice(["mala", "regular", "buena"], size=80, p=[0.2, 0.35, 0.45]),
    "haskids":  np.random.choice(["sin hijos", "con hijos"], size=80, p=[0.55, 0.45]),
    "roe":      np.clip(np.random.normal(loc=12, scale=6, size=80), -10, 40),
    "salary":   np.clip(np.random.normal(loc=120, scale=35, size=80), 20, 300)
})
df.head()
```

::: {.callout-note}
### Sintaxis clave (crear datos)

- `pd.DataFrame({...})` crea una tabla (DataFrame).
- `np.random.choice([...], size=n)` genera categor√≠as aleatorias.
- `np.random.normal(loc, scale, size)` genera n√∫meros.
- `np.clip(x, a, b)` fuerza a que `x` quede entre `a` y `b`.
:::

---

## 3. Categor√≠as: frecuencias y gr√°ficos

### 3.1 Frecuencias y porcentajes (`value_counts`)

```{python}
freq = df["marriage"].value_counts()
freq
```

```{python}
df["marriage"].value_counts(normalize=True) * 100
```

::: {.callout-note}
### Sintaxis clave (`value_counts`)

- `serie.value_counts()` ‚Üí conteos por categor√≠a.
- `normalize=True` ‚Üí proporciones (suman 1). Multiplica por 100 si quieres porcentaje.
:::

---

### 3.2 Pastel (pie chart)

```{python}
freq.plot(kind="pie", autopct="%1.1f%%")
plt.ylabel("")  # quita etiqueta del eje y
plt.title("marriage ‚Äî gr√°fico de pastel")
plt.show()
```

::: {.callout-note}
### Sintaxis clave (pie)

- `freq.plot(kind="pie")` grafica desde una Serie.
- `autopct="..."` muestra porcentajes dentro del pastel.
- `plt.show()` ‚Äúcierra‚Äù y muestra la figura (buena pr√°ctica).
:::

---

### 3.3 Barras horizontales

```{python}
freq.sort_values().plot(kind="barh")
plt.title("marriage ‚Äî barras horizontales")
plt.xlabel("frecuencia")
plt.ylabel("categor√≠a")
plt.show()
```

---

## 4. Tablas por subgrupos y contingencia (`crosstab`)

### 4.1 Tabla cruzada (conteos)

```{python}
tabla = pd.crosstab(df["marriage"], df["haskids"])
tabla
```

::: {.callout-note}
### Sintaxis clave (`crosstab`)

- `pd.crosstab(filas, columnas)` ‚Üí tabla de conteos.
- Funciona perfecto para variables categ√≥ricas.
:::

---

### 4.2 Barras apiladas y agrupadas

```{python}
tabla.plot(kind="bar", stacked=True)
plt.title("marriage vs haskids ‚Äî barras apiladas")
plt.xlabel("marriage")
plt.ylabel("frecuencia")
plt.show()
```

```{python}
tabla.plot(kind="bar", stacked=False)
plt.title("marriage vs haskids ‚Äî barras agrupadas")
plt.xlabel("marriage")
plt.ylabel("frecuencia")
plt.show()
```

---

### 4.3 Tablas normalizadas (proporciones)

```{python}
pd.crosstab(df["marriage"], df["haskids"], normalize=True)
```

```{python}
pd.crosstab(df["marriage"], df["haskids"], normalize="index")
```

```{python}
pd.crosstab(df["marriage"], df["haskids"], normalize="columns")
```

::: {.callout-note}
### Sintaxis clave (normalize)

- `normalize=True` ‚Üí proporci√≥n del total (toda la tabla suma 1).
- `normalize="index"` ‚Üí proporciones por fila (cada fila suma 1).
- `normalize="columns"` ‚Üí proporciones por columna (cada columna suma 1).
:::

---

## 5. Num√©ricas: histogramas, densidad y ECDF

### 5.1 Histograma (frecuencia)

```{python}
plt.hist(df["roe"], bins=12)
plt.title("Histograma de ROE (frecuencia)")
plt.xlabel("roe")
plt.ylabel("frecuencia")
plt.show()
```

### 5.2 Histograma (densidad)

```{python}
plt.hist(df["roe"], bins=12, density=True)
plt.title("Histograma de ROE (densidad)")
plt.xlabel("roe")
plt.ylabel("densidad")
plt.show()
```

::: {.callout-note}
### Sintaxis clave (`density=True`)

- `density=True` cambia la escala: el √°rea total del histograma ‚âà 1.
- √ötil para comparar distribuciones entre grupos o muestras distintas.
:::

---

### 5.3 Densidad KDE (opcional)

La KDE puede depender de paquetes extra. En el manual (Quarto) la dejamos desactivada.  
En Colab puedes activarla si tienes lo necesario.

```{python}
#| eval: false
df["roe"].plot(kind="density")
plt.title("KDE de ROE (opcional)")
plt.xlabel("roe")
plt.show()
```

---

### 5.4 ECDF (acumulada emp√≠rica)

```{python}
x = np.sort(df["roe"].to_numpy())
y = np.arange(1, len(x) + 1) / len(x)

plt.plot(x, y)
plt.title("ECDF de ROE")
plt.xlabel("roe (x)")
plt.ylabel("F(x) acumulada")
plt.ylim(0, 1)
plt.show()
```

::: {.callout-note}
### Sintaxis clave (ECDF)

- `to_numpy()` convierte la columna a arreglo.
- `np.sort(...)` ordena de menor a mayor.
- `np.arange(1, n+1)/n` crea el acumulado: 1/n, 2/n, ..., 1.
:::

---

## 6. Resumen num√©rico: estad√≠sticos y matrices

### 6.1 Resumen r√°pido con `describe`

```{python}
df[["roe", "salary"]].describe()
```

### 6.2 Media, mediana, varianza, desviaci√≥n est√°ndar

```{python}
df["roe"].mean(), df["roe"].median(), df["roe"].var(), df["roe"].std()
```

### 6.3 Covarianza y correlaci√≥n

```{python}
df[["salary", "roe"]].cov()
```

```{python}
df[["salary", "roe"]].corr()
```

::: {.callout-note}
### Sintaxis clave (cov/corr)

- `df[cols]` selecciona columnas.
- `.cov()` y `.corr()` devuelven matrices (2√ó2 si son 2 variables).
:::

---

## 7. Boxplots

```{python}
plt.boxplot(df["roe"].dropna())
plt.title("Boxplot de ROE")
plt.ylabel("roe")
plt.show()
```

Por grupo:

```{python}
df.boxplot(column="roe", by="haskids")
plt.title("ROE por haskids (boxplot)")
plt.suptitle("")  # quita el t√≠tulo autom√°tico
plt.xlabel("haskids")
plt.ylabel("roe")
plt.show()
```

---

## 8. Aplicaci√≥n con datos reales (opcional, online)

Si quieres practicar con **bases reales**, puedes usar conjuntos de datos educativos (por ejemplo, paquetes como `wooldridge`).  
Esto requiere instalaci√≥n y/o internet, por eso en Quarto no se ejecuta.

```{python}
#| eval: false
# En VSCode: pip install wooldridge
# En Colab:  !pip -q install wooldridge
import wooldridge as woo
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

affairs = woo.dataWoo("affairs")

# Frecuencias y tablas
affairs["ratemarr"].value_counts()
pd.crosstab(affairs["ratemarr"], affairs["kids"], normalize="index")

ceosal1 = woo.dataWoo("ceosal1")

# Histograma (frecuencia y densidad)
plt.hist(ceosal1["roe"], bins=20)
plt.title("Histograma de ROE (ceosal1)")
plt.show()

plt.hist(ceosal1["roe"], bins=20, density=True)
plt.title("Histograma de ROE (densidad, ceosal1)")
plt.show()

# ECDF
x = np.sort(ceosal1["roe"].to_numpy())
y = np.arange(1, len(x) + 1) / len(x)
plt.plot(x, y)
plt.title("ECDF de ROE (ceosal1)")
plt.ylim(0, 1)
plt.show()

# Estad√≠sticos y matrices
ceosal1[["salary", "roe"]].describe()
ceosal1[["salary", "roe"]].cov()
ceosal1[["salary", "roe"]].corr()

# Boxplot
ceosal1.boxplot(column="roe")
plt.title("Boxplot de ROE (ceosal1)")
plt.show()
```

---

## Ejercicios propuestos

1) **Frecuencias + barras**  
   Calcula `value_counts()` de `marriage` y grafica barras horizontales.

   **Respuesta esperada:** 3 barras con los conteos por categor√≠a.

2) **Crosstab normalizado por filas**  
   Crea `pd.crosstab(marriage, haskids, normalize="index")`.

   **Respuesta esperada:** cada fila suma 1.

3) **Frecuencia vs densidad**  
   Grafica dos histogramas de `roe`: uno con `density=False` y otro con `density=True`.

   **Respuesta esperada:** cambia la escala del eje y (frecuencia vs densidad).

4) **ECDF y percentil**  
   Construye la ECDF de `roe` y estima el valor del percentil 90.

   **Respuesta esperada:** un n√∫mero cercano a `df["roe"].quantile(0.9)`.

5) **Cov y corr**  
   Calcula `cov()` y `corr()` para `salary` y `roe`.

   **Respuesta esperada:** dos matrices 2√ó2.

6) **Boxplot por grupo**  
   Crea un boxplot de `roe` por `haskids`.

   **Respuesta esperada:** 2 cajas (una por cada categor√≠a de `haskids`).

---

::: {.content-visible when-format="pdf"}
## Glosario (para Colab)

- **frecuencia**: conteos.
- **proporci√≥n**: conteos / total.
- **crosstab**: tabla cruzada.
- **densidad**: histograma escalado (`density=True`).
- **KDE**: densidad estimada (kernel).
- **boxplot**: gr√°fico de caja.
- **cov / corr**: covarianza / correlaci√≥n.
:::
