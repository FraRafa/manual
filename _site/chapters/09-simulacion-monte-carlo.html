<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Cap√≠tulo 9 ‚Äî Simulaci√≥n de Monte Carlo ‚Äì Manual de Python</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/08-python-avanzado-condicionales-bucles-funciones-sympy.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-0edeb2bfa3bdafc2264c871846f989cd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating slimcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/09-simulacion-monte-carlo.html"><span class="chapter-title">Cap√≠tulo 9 ‚Äî Simulaci√≥n de Monte Carlo</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Manual de Python</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Manual de Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01-empezando-en-python.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Cap√≠tulo 1 ‚Äî Empezando en Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-objetos-en-python.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Cap√≠tulo 2 ‚Äî Objetos en Python (variables, listas, numpy y pandas)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03-datos-externos.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Cap√≠tulo 3 ‚Äî Datos externos (leer y guardar archivos con pandas)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04-graficos-basicos-matplotlib.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Cap√≠tulo 4 ‚Äî Gr√°ficos b√°sicos con matplotlib</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05-estadisticas-descriptivas.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Cap√≠tulo 5 ‚Äî Estad√≠sticas descriptivas (tablas, gr√°ficos y resumen)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/06-distribuciones-de-probabilidad.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Cap√≠tulo 6 ‚Äî Distribuciones de probabilidad (scipy.stats)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/07-intervalos-de-confianza-e-inferencia.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Cap√≠tulo 7 ‚Äî Intervalos de confianza e inferencia (t-test)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/08-python-avanzado-condicionales-bucles-funciones-sympy.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Cap√≠tulo 8 ‚Äî Python avanzado: condicionales, bucles, funciones y SymPy</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/09-simulacion-monte-carlo.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Cap√≠tulo 9 ‚Äî Simulaci√≥n de Monte Carlo</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#qu√©-es-una-simulaci√≥n-de-monte-carlo-en-c√≥digo" id="toc-qu√©-es-una-simulaci√≥n-de-monte-carlo-en-c√≥digo" class="nav-link active" data-scroll-target="#qu√©-es-una-simulaci√≥n-de-monte-carlo-en-c√≥digo">1. ¬øQu√© es una simulaci√≥n de Monte Carlo (en c√≥digo)?</a></li>
  <li><a href="#teorema-del-l√≠mite-central-tlc-con-una-poblaci√≥n-asim√©trica" id="toc-teorema-del-l√≠mite-central-tlc-con-una-poblaci√≥n-asim√©trica" class="nav-link" data-scroll-target="#teorema-del-l√≠mite-central-tlc-con-una-poblaci√≥n-asim√©trica">2. Teorema del L√≠mite Central (TLC) con una poblaci√≥n asim√©trica</a>
  <ul class="collapse">
  <li><a href="#poblaci√≥n-asim√©trica-chi-cuadrado" id="toc-poblaci√≥n-asim√©trica-chi-cuadrado" class="nav-link" data-scroll-target="#poblaci√≥n-asim√©trica-chi-cuadrado">2.1 Poblaci√≥n (asim√©trica): chi-cuadrado</a></li>
  <li><a href="#una-muestra-y-su-promedio" id="toc-una-muestra-y-su-promedio" class="nav-link" data-scroll-target="#una-muestra-y-su-promedio">2.2 Una muestra y su promedio</a></li>
  <li><a href="#muchas-muestras-distribuci√≥n-del-promedio-muestral" id="toc-muchas-muestras-distribuci√≥n-del-promedio-muestral" class="nav-link" data-scroll-target="#muchas-muestras-distribuci√≥n-del-promedio-muestral">2.3 Muchas muestras: distribuci√≥n del promedio muestral</a></li>
  <li><a href="#ley-de-los-grandes-n√∫meros-promedio-vs-n" id="toc-ley-de-los-grandes-n√∫meros-promedio-vs-n" class="nav-link" data-scroll-target="#ley-de-los-grandes-n√∫meros-promedio-vs-n">2.4 Ley de los grandes n√∫meros (promedio vs n)</a></li>
  </ul></li>
  <li><a href="#simulaci√≥n-de-pruebas-t-e-intervalos-de-confianza" id="toc-simulaci√≥n-de-pruebas-t-e-intervalos-de-confianza" class="nav-link" data-scroll-target="#simulaci√≥n-de-pruebas-t-e-intervalos-de-confianza">3. Simulaci√≥n de pruebas t e intervalos de confianza</a>
  <ul class="collapse">
  <li><a href="#poblaci√≥n-normal-para-simular" id="toc-poblaci√≥n-normal-para-simular" class="nav-link" data-scroll-target="#poblaci√≥n-normal-para-simular">3.1 Poblaci√≥n normal (para simular)</a></li>
  <li><a href="#una-muestra-promedio-desviaci√≥n-y-se" id="toc-una-muestra-promedio-desviaci√≥n-y-se" class="nav-link" data-scroll-target="#una-muestra-promedio-desviaci√≥n-y-se">3.2 Una muestra: promedio, desviaci√≥n y SE</a></li>
  <li><a href="#prueba-t-bilateral-y-valor-cr√≠tico" id="toc-prueba-t-bilateral-y-valor-cr√≠tico" class="nav-link" data-scroll-target="#prueba-t-bilateral-y-valor-cr√≠tico">3.3 Prueba t (bilateral) y valor cr√≠tico</a></li>
  <li><a href="#intervalo-de-confianza-e-indicador-contiene-mu" id="toc-intervalo-de-confianza-e-indicador-contiene-mu" class="nav-link" data-scroll-target="#intervalo-de-confianza-e-indicador-contiene-mu">3.4 Intervalo de confianza e indicador ‚Äú¬øcontiene mu?‚Äù</a></li>
  <li><a href="#monte-carlo-repetir-r-veces-p-values-error-tipo-i-y-cobertura" id="toc-monte-carlo-repetir-r-veces-p-values-error-tipo-i-y-cobertura" class="nav-link" data-scroll-target="#monte-carlo-repetir-r-veces-p-values-error-tipo-i-y-cobertura">3.5 Monte Carlo: repetir r veces (p-values, error tipo I y cobertura)</a></li>
  <li><a href="#visualizar-intervalos-de-confianza-rojo-no-cubre-mu" id="toc-visualizar-intervalos-de-confianza-rojo-no-cubre-mu" class="nav-link" data-scroll-target="#visualizar-intervalos-de-confianza-rojo-no-cubre-mu">3.6 Visualizar intervalos de confianza (rojo = no cubre mu)</a></li>
  </ul></li>
  <li><a href="#ejercicios-propuestos" id="toc-ejercicios-propuestos" class="nav-link" data-scroll-target="#ejercicios-propuestos">Ejercicios propuestos</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Cap√≠tulo 9 ‚Äî Simulaci√≥n de Monte Carlo</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><a href="https://colab.research.google.com/github/FraRafa/manual/blob/main/notebooks/09-simulacion-monte-carlo.ipynb" class="btn btn-success" target="_blank">üöÄ Abrir este cap√≠tulo en Google Colab</a></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Objetivos del cap√≠tulo
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Entender <strong>qu√© significa simular</strong> en Python: repetir un experimento aleatorio muchas veces.</li>
<li>Programar una simulaci√≥n para visualizar el <strong>Teorema del L√≠mite Central (TLC)</strong> usando promedios muestrales.</li>
<li>Programar una simulaci√≥n de Monte Carlo para estudiar:
<ul>
<li>la frecuencia de <strong>rechazos</strong> en una prueba t cuando H0 es verdadera (error Tipo I),</li>
<li>la <strong>cobertura</strong> de intervalos de confianza.</li>
</ul></li>
</ul>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div style="margin-top: 1.2rem;">

</div>
<details>
<summary>
<strong>Glosario</strong>
</summary>
<ul>
<li><strong>Monte Carlo</strong>: repetir muchas veces un experimento aleatorio para aproximar un resultado.</li>
<li><strong>replicaci√≥n</strong>: una corrida/iteraci√≥n de la simulaci√≥n (una vez que ‚Äúrepites‚Äù).</li>
<li><strong>semilla</strong>: n√∫mero que fija el generador aleatorio para reproducibilidad.</li>
<li><strong>TLC / CLT</strong>: el promedio muestral tiende a ser normal cuando n crece.</li>
<li><strong>IID</strong>: independientes e id√©nticamente distribuidas.</li>
<li><strong>cobertura</strong>: proporci√≥n de intervalos que contienen el par√°metro verdadero.</li>
<li><strong>error Tipo I</strong>: rechazar H0 siendo H0 verdadera.</li>
</ul>
</details>
</div></div><hr>
<section id="qu√©-es-una-simulaci√≥n-de-monte-carlo-en-c√≥digo" class="level2">
<h2 class="anchored" data-anchor-id="qu√©-es-una-simulaci√≥n-de-monte-carlo-en-c√≥digo">1. ¬øQu√© es una simulaci√≥n de Monte Carlo (en c√≥digo)?</h2>
<p>En Python, una simulaci√≥n de Monte Carlo casi siempre se ve as√≠:</p>
<ol type="1">
<li>defines una distribuci√≥n o un mecanismo aleatorio,<br>
</li>
<li>repites <code>r</code> veces (un bucle),<br>
</li>
<li>guardas resultados en arrays,<br>
</li>
<li>resumes con una tabla, proporci√≥n o gr√°fico.</li>
</ol>
<p>La parte clave para programar bien no es ‚Äúestad√≠stica‚Äù, sino:</p>
<ul>
<li><strong>organizar resultados</strong> (arrays),</li>
<li><strong>reproducibilidad</strong> (semilla),</li>
<li><strong>evitar errores de l√≥gica</strong> (√≠ndices, condiciones, acumuladores).</li>
</ul>
<hr>
</section>
<section id="teorema-del-l√≠mite-central-tlc-con-una-poblaci√≥n-asim√©trica" class="level2">
<h2 class="anchored" data-anchor-id="teorema-del-l√≠mite-central-tlc-con-una-poblaci√≥n-asim√©trica">2. Teorema del L√≠mite Central (TLC) con una poblaci√≥n asim√©trica</h2>
<section id="poblaci√≥n-asim√©trica-chi-cuadrado" class="level3">
<h3 class="anchored" data-anchor-id="poblaci√≥n-asim√©trica-chi-cuadrado">2.1 Poblaci√≥n (asim√©trica): chi-cuadrado</h3>
<div id="850752f0" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejemplo de distribuci√≥n poblacional asim√©trica (chi-cuadrado)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">20</span>, num<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="dv">1</span>  <span class="co"># grados de libertad</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>fy <span class="op">=</span> stats.chi2.pdf(y, m)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>plt.plot(y, fy, linestyle<span class="op">=</span><span class="st">"-"</span>, color<span class="op">=</span><span class="st">"black"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="vs">rf"Distribuci√≥n poblacional: PDF de Y ~ </span><span class="dv">$</span><span class="er">\</span><span class="vs">chi</span><span class="dv">^</span><span class="vs">2</span><span class="dv">$</span><span class="kw">(</span><span class="sc">{</span>m<span class="sc">}</span><span class="kw">)</span><span class="vs">"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Y"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"f(Y)"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Media y varianza poblacionales (para chi-cuadrado con m g.l.)</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>EYi <span class="op">=</span> m</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>VYi <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> m</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Media poblacional: E(Y_i) = </span><span class="sc">{</span>EYi<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Varianza poblacional: Var(Y_i) = </span><span class="sc">{</span>VYi<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="09-simulacion-monte-carlo_files/figure-html/cell-3-output-1.png" width="829" height="520" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Media poblacional: E(Y_i) = 1

Varianza poblacional: Var(Y_i) = 2
</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Sintaxis clave
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>np.linspace(a, b, num=k)</code> crea k puntos entre a y b (√∫til para graficar).</li>
<li><code>stats.chi2.pdf(y, m)</code> eval√∫a la PDF en cada punto de <code>y</code>.</li>
<li><code>plt.plot(...)</code> grafica l√≠neas; <code>plt.grid()</code> agrega grilla.</li>
</ul>
</div>
</div>
<hr>
</section>
<section id="una-muestra-y-su-promedio" class="level3">
<h3 class="anchored" data-anchor-id="una-muestra-y-su-promedio">2.2 Una muestra y su promedio</h3>
<div id="1c05e4c4" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Definimos el valor semilla (None = resultados distintos cada ejecuci√≥n)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>semilla <span class="op">=</span> <span class="va">None</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Tama√±o de muestra</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Muestreo (una muestra desde la poblaci√≥n chi-cuadrado)</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>muestra <span class="op">=</span> stats.chi2.rvs(m, size<span class="op">=</span>n, random_state<span class="op">=</span>semilla)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Promedio de la muestra</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>y_promedio <span class="op">=</span> muestra.mean()</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Promedio de la muestra (l√≠nea verde): </span><span class="sc">{</span>y_promedio<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Gr√°fico: observaciones y promedio</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>plt.scatter(np.arange(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>), muestra, label<span class="op">=</span><span class="st">"Observaciones"</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>plt.axhline(y_promedio, color<span class="op">=</span><span class="st">"green"</span>, label<span class="op">=</span><span class="st">"Promedio muestral"</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Y(i)"</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Individuo (i)"</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">"upper center"</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.12</span>))</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Promedio de la muestra (l√≠nea verde): 0.2948</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="09-simulacion-monte-carlo_files/figure-html/cell-4-output-2.png" width="829" height="552" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>Error com√∫n
</div>
</div>
<div class="callout-body-container callout-body">
<p>Si quieres resultados <strong>reproducibles</strong>, no dejes <code>semilla = None</code>.<br>
En ese caso, usa un entero (ej. <code>semilla = 1</code>).</p>
</div>
</div>
<hr>
</section>
<section id="muchas-muestras-distribuci√≥n-del-promedio-muestral" class="level3">
<h3 class="anchored" data-anchor-id="muchas-muestras-distribuci√≥n-del-promedio-muestral">2.3 Muchas muestras: distribuci√≥n del promedio muestral</h3>
<p>Aqu√≠ repetimos el muestreo <code>r</code> veces y guardamos los promedios en un array.</p>
<div id="84113964" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>campana <span class="op">=</span> <span class="va">True</span>          <span class="co"># si True, sobrepone una normal te√≥rica</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>limites <span class="op">=</span> <span class="va">None</span>          <span class="co"># si quieres un rango fijo, usa limites=(a, b)</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>semilla <span class="op">=</span> <span class="va">None</span>          <span class="co"># semilla base</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">5</span>                   <span class="co"># tama√±o de muestra</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="dv">1000</span>                <span class="co"># n√∫mero de replicaciones</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>promedios <span class="op">=</span> np.zeros(r)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(r):</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    semilla2 <span class="op">=</span> semilla <span class="cf">if</span> semilla <span class="kw">is</span> <span class="va">None</span> <span class="cf">else</span> semilla <span class="op">+</span> j</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    muestra <span class="op">=</span> stats.chi2.rvs(m, size<span class="op">=</span>n, random_state<span class="op">=</span>semilla2)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    promedios[j] <span class="op">=</span> muestra.mean()</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Histograma de promedios</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>plt.hist(promedios, bins<span class="op">=</span><span class="dv">15</span>, density<span class="op">=</span><span class="va">True</span>, edgecolor<span class="op">=</span><span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.9</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>         label<span class="op">=</span><span class="st">"Distribuci√≥n del promedio muestral"</span>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Normal te√≥rica aproximada (por TLC): N(E(Y), Var(Y)/n)</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> campana:</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    EYp <span class="op">=</span> EYi</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    VYp <span class="op">=</span> VYi <span class="op">/</span> n</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> limites <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> np.linspace(EYp <span class="op">-</span> <span class="dv">3</span><span class="op">*</span>np.sqrt(VYp), EYp <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>np.sqrt(VYp), num<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> np.linspace(<span class="op">*</span>limites, num<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    pdfx <span class="op">=</span> stats.norm.pdf(x, EYp, np.sqrt(VYp))</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    plt.plot(x, pdfx, linewidth<span class="op">=</span><span class="dv">3</span>, label<span class="op">=</span><span class="st">"Normal te√≥rica (aprox.)"</span>)</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Densidad"</span>)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Promedio muestral"</span>)</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"TLC: histograma del promedio muestral"</span>)</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">"upper center"</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.12</span>))</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="09-simulacion-monte-carlo_files/figure-html/cell-5-output-1.png" width="829" height="579" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Sintaxis clave (Monte Carlo)
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>np.zeros(r)</code> reserva un array para guardar <code>r</code> resultados.</li>
<li>Dentro del bucle:
<ul>
<li>generas una muestra aleatoria,</li>
<li>calculas su promedio,</li>
<li>lo guardas en <code>promedios[j]</code>.</li>
</ul></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Tip: controla semillas por iteraci√≥n
</div>
</div>
<div class="callout-body-container callout-body">
<p>La l√≠nea <code>semilla2 = semilla + j</code> sirve para que cada r√©plica sea distinta, pero reproducible.</p>
</div>
</div>
<hr>
</section>
<section id="ley-de-los-grandes-n√∫meros-promedio-vs-n" class="level3">
<h3 class="anchored" data-anchor-id="ley-de-los-grandes-n√∫meros-promedio-vs-n">2.4 Ley de los grandes n√∫meros (promedio vs n)</h3>
<div id="1c6c4e61" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>semilla <span class="op">=</span> <span class="va">None</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>nmax <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>promedios_nmax <span class="op">=</span> np.zeros(nmax <span class="op">-</span> <span class="dv">2</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, nmax):</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    muestra <span class="op">=</span> stats.chi2.rvs(m, size<span class="op">=</span>j, random_state<span class="op">=</span>semilla)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    promedios_nmax[j <span class="op">-</span> <span class="dv">2</span>] <span class="op">=</span> muestra.mean()</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>plt.plot(promedios_nmax)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>plt.axhline(EYi, color<span class="op">=</span><span class="st">"red"</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Tama√±o de muestra (n)"</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Promedio muestral"</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Ley de los grandes n√∫meros: promedio muestral ‚Üí media poblacional"</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="09-simulacion-monte-carlo_files/figure-html/cell-6-output-1.png" width="840" height="517" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="simulaci√≥n-de-pruebas-t-e-intervalos-de-confianza" class="level2">
<h2 class="anchored" data-anchor-id="simulaci√≥n-de-pruebas-t-e-intervalos-de-confianza">3. Simulaci√≥n de pruebas t e intervalos de confianza</h2>
<section id="poblaci√≥n-normal-para-simular" class="level3">
<h3 class="anchored" data-anchor-id="poblaci√≥n-normal-para-simular">3.1 Poblaci√≥n normal (para simular)</h3>
<div id="2bc4e449" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>mu <span class="op">=</span> <span class="dv">40</span>                 <span class="co"># media poblacional</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> np.sqrt(<span class="dv">100</span>)    <span class="co"># desviaci√≥n est√°ndar poblacional</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.linspace(<span class="dv">10</span>, <span class="dv">70</span>, num<span class="op">=</span><span class="dv">400</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>fy <span class="op">=</span> stats.norm.pdf(y, mu, sigma)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>plt.plot(y, fy)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Poblaci√≥n normal: PDF"</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="09-simulacion-monte-carlo_files/figure-html/cell-7-output-1.png" width="827" height="493" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="una-muestra-promedio-desviaci√≥n-y-se" class="level3">
<h3 class="anchored" data-anchor-id="una-muestra-promedio-desviaci√≥n-y-se">3.2 Una muestra: promedio, desviaci√≥n y SE</h3>
<div id="630b1599" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>semilla <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>muestra <span class="op">=</span> stats.norm.rvs(mu, sigma, size<span class="op">=</span>n, random_state<span class="op">=</span>semilla)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>promedio_m <span class="op">=</span> np.mean(muestra)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>desv_est_m <span class="op">=</span> np.std(muestra, ddof<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>error_est <span class="op">=</span> desv_est_m <span class="op">/</span> np.sqrt(n)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Promedio muestral: </span><span class="sc">{</span>promedio_m<span class="sc">:.4f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Desviaci√≥n est√°ndar muestral: </span><span class="sc">{</span>desv_est_m<span class="sc">:.4f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Error est√°ndar: </span><span class="sc">{</span>error_est<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>plt.scatter(np.arange(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>), muestra, label<span class="op">=</span><span class="st">"Muestra"</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>plt.axhline(promedio_m, color<span class="op">=</span><span class="st">"green"</span>, label<span class="op">=</span><span class="st">"Promedio"</span>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">"upper center"</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.12</span>))</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Promedio muestral: 39.0286

Desviaci√≥n est√°ndar muestral: 12.5532

Error est√°ndar: 3.9697</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="09-simulacion-monte-carlo_files/figure-html/cell-8-output-2.png" width="800" height="552" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>Error com√∫n: <code>ddof</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Para inferencia con muestras, usa <code>np.std(..., ddof=1)</code> (desviaci√≥n est√°ndar muestral).</p>
</div>
</div>
<hr>
</section>
<section id="prueba-t-bilateral-y-valor-cr√≠tico" class="level3">
<h3 class="anchored" data-anchor-id="prueba-t-bilateral-y-valor-cr√≠tico">3.3 Prueba t (bilateral) y valor cr√≠tico</h3>
<div id="9af21093" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>mu0 <span class="op">=</span> mu  <span class="co"># H0 verdadera en este experimento</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>prueba_t <span class="op">=</span> stats.ttest_1samp(muestra, popmean<span class="op">=</span>mu0)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>valor_crit <span class="op">=</span> stats.t.ppf(<span class="dv">1</span> <span class="op">-</span> alpha<span class="op">/</span><span class="dv">2</span>, df<span class="op">=</span>n <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>estadistico_t <span class="op">=</span> prueba_t.statistic</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>valorp <span class="op">=</span> prueba_t.pvalue</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Estad√≠stico t: </span><span class="sc">{</span>estadistico_t<span class="sc">:.4f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Valor cr√≠tico (</span><span class="sc">{</span>(<span class="dv">1</span><span class="op">-</span>alpha)<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">% confianza): </span><span class="sc">{</span>valor_crit<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Valor p: </span><span class="sc">{</span>valorp<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Estad√≠stico t: -0.2447

Valor cr√≠tico (95.00% confianza): 2.26

Valor p: 0.8122</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Sintaxis clave
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>ttest_1samp(muestra, popmean=mu0)</code> devuelve <code>.statistic</code> y <code>.pvalue</code>.</li>
<li><code>t.ppf(1 - alpha/2, df=n-1)</code> es el cuantil bilateral para el valor cr√≠tico.</li>
</ul>
</div>
</div>
<hr>
</section>
<section id="intervalo-de-confianza-e-indicador-contiene-mu" class="level3">
<h3 class="anchored" data-anchor-id="intervalo-de-confianza-e-indicador-contiene-mu">3.4 Intervalo de confianza e indicador ‚Äú¬øcontiene mu?‚Äù</h3>
<div id="be935999" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>LI <span class="op">=</span> promedio_m <span class="op">-</span> valor_crit <span class="op">*</span> error_est</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>LS <span class="op">=</span> promedio_m <span class="op">+</span> valor_crit <span class="op">*</span> error_est</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"IC al </span><span class="sc">{</span>(<span class="dv">1</span><span class="op">-</span>alpha)<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%: [</span><span class="sc">{</span>LI<span class="sc">:.2f}</span><span class="ss">, </span><span class="sc">{</span>LS<span class="sc">:.2f}</span><span class="ss">]</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"¬øEl intervalo contiene a mu? </span><span class="sc">{</span><span class="st">'S√≠'</span> <span class="cf">if</span> (mu <span class="op">&gt;=</span> LI <span class="kw">and</span> mu <span class="op">&lt;=</span> LS) <span class="cf">else</span> <span class="st">'No'</span><span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>IC al 95.00%: [30.05, 48.01]

¬øEl intervalo contiene a mu? S√≠</code></pre>
</div>
</div>
<hr>
</section>
<section id="monte-carlo-repetir-r-veces-p-values-error-tipo-i-y-cobertura" class="level3">
<h3 class="anchored" data-anchor-id="monte-carlo-repetir-r-veces-p-values-error-tipo-i-y-cobertura">3.5 Monte Carlo: repetir r veces (p-values, error tipo I y cobertura)</h3>
<div id="69d26703" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mu <span class="op">=</span> <span class="dv">40</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> np.sqrt(<span class="dv">100</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>semilla <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>mu0 <span class="op">=</span> mu</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>resultados_valores_p <span class="op">=</span> np.zeros(r)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>resultados_error1 <span class="op">=</span> np.zeros(r)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>resultados_LI <span class="op">=</span> np.zeros(r)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>resultados_LS <span class="op">=</span> np.zeros(r)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>resultados_intervalo_mal <span class="op">=</span> np.zeros(r)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(r):</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    semilla2 <span class="op">=</span> <span class="va">None</span> <span class="cf">if</span> semilla <span class="kw">is</span> <span class="va">None</span> <span class="cf">else</span> semilla <span class="op">+</span> i</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    muestra <span class="op">=</span> stats.norm.rvs(mu, sigma, size<span class="op">=</span>n, random_state<span class="op">=</span>semilla2)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    promedio_m <span class="op">=</span> np.mean(muestra)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    desv_est_m <span class="op">=</span> np.std(muestra, ddof<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    error_est <span class="op">=</span> desv_est_m <span class="op">/</span> np.sqrt(n)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    prueba_t <span class="op">=</span> stats.ttest_1samp(muestra, popmean<span class="op">=</span>mu0)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    valor_crit <span class="op">=</span> stats.t.ppf(<span class="dv">1</span> <span class="op">-</span> alpha<span class="op">/</span><span class="dv">2</span>, df<span class="op">=</span>n <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    valorp <span class="op">=</span> prueba_t.pvalue</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    resultados_valores_p[i] <span class="op">=</span> valorp</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> valorp <span class="op">&lt;</span> alpha:</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>        resultados_error1[i] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>    LI <span class="op">=</span> promedio_m <span class="op">-</span> valor_crit <span class="op">*</span> error_est</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>    LS <span class="op">=</span> promedio_m <span class="op">+</span> valor_crit <span class="op">*</span> error_est</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    resultados_LI[i] <span class="op">=</span> LI</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    resultados_LS[i] <span class="op">=</span> LS</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (mu <span class="op">&lt;</span> LI) <span class="kw">or</span> (mu <span class="op">&gt;</span> LS):</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>        resultados_intervalo_mal[i] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>tabla_valores_p <span class="op">=</span> pd.DataFrame({</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Valores p"</span>: resultados_valores_p,</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Error Tipo 1"</span>: resultados_error1,</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Lim inferior"</span>: resultados_LI,</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">"L√≠m superior"</span>: resultados_LS,</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">"¬øNo contiene mu?"</span>: resultados_intervalo_mal</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>tabla_valores_p<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span> <span class="cf">if</span> r <span class="op">&lt;=</span> <span class="dv">20</span> <span class="cf">else</span> <span class="st">"M√°s de 20 simulaciones: omitimos tabla</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Errores tipo I: </span><span class="sc">{</span><span class="bu">sum</span>(resultados_error1)<span class="sc">}</span><span class="ss"> de </span><span class="sc">{</span>r<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span><span class="bu">sum</span>(resultados_error1)<span class="op">/</span>r<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%)"</span>)</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Intervalos que NO contienen mu: </span><span class="sc">{</span><span class="bu">sum</span>(resultados_intervalo_mal)<span class="sc">}</span><span class="ss"> de </span><span class="sc">{</span>r<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span><span class="bu">sum</span>(resultados_intervalo_mal)<span class="op">/</span>r<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Valores p  Error Tipo 1  Lim inferior  L√≠m superior  ¬øNo contiene mu?
0    0.812170           0.0     30.048592     48.008590               0.0
1    0.106021           0.0     25.735345     41.637656               0.0
2    0.638300           0.0     32.061999     45.128436               0.0
3    0.334230           0.0     31.574147     43.187785               0.0
4    0.491500           0.0     34.962626     49.713357               0.0
5    0.808156           0.0     29.800708     48.168869               0.0
6    0.812628           0.0     33.877092     47.604126               0.0
7    0.512978           0.0     31.488820     55.843483               0.0
8    0.007517           1.0     31.413388     38.239187               1.0
9    0.816756           0.0     34.927793     46.268373               0.0
10   0.441022           0.0     29.081732     45.181874               0.0
11   0.906862           0.0     30.128664     48.874181               0.0
12   0.102848           0.0     38.776779     51.164886               0.0
13   0.797112           0.0     31.495786     46.721771               0.0
14   0.033067           1.0     30.271250     39.486101               1.0
15   0.046063           1.0     30.417601     39.894965               1.0
16   0.490989           0.0     34.941927     49.761617               0.0
17   0.167283           0.0     38.086729     49.477681               0.0
18   0.505837           0.0     33.422185     43.492977               0.0
19   0.871146           0.0     31.840531     47.038261               0.0

Errores tipo I: 3.0 de 20 (15.00%)
Intervalos que NO contienen mu: 3.0 de 20 (15.00%)</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Interpretaci√≥n en modo ‚Äúc√≥digo‚Äù
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>sum(resultados_error1)/r</code> es una <strong>proporci√≥n</strong> (frecuencia relativa).</li>
<li><code>resultados_intervalo_mal</code> marca cuando el IC <strong>falla</strong> en cubrir <code>mu</code>.</li>
</ul>
</div>
</div>
<hr>
</section>
<section id="visualizar-intervalos-de-confianza-rojo-no-cubre-mu" class="level3">
<h3 class="anchored" data-anchor-id="visualizar-intervalos-de-confianza-rojo-no-cubre-mu">3.6 Visualizar intervalos de confianza (rojo = no cubre mu)</h3>
<div id="fe178850" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>r_ej <span class="op">=</span> <span class="dv">20</span>  <span class="co"># debe ser &lt;= r</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">3</span>, <span class="dv">5</span>))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="dv">10</span>, <span class="dv">70</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="op">-</span><span class="dv">1</span>, r_ej)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(r_ej):</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> <span class="st">"grey"</span> <span class="cf">if</span> (mu <span class="op">&gt;</span> resultados_LI[i] <span class="kw">and</span> mu <span class="op">&lt;</span> resultados_LS[i]) <span class="cf">else</span> <span class="st">"red"</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    plt.plot([resultados_LI[i], resultados_LS[i]], [i, i], linestyle<span class="op">=</span><span class="st">"-"</span>, color<span class="op">=</span>color)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>plt.axvline(mu, linestyle<span class="op">=</span><span class="st">"--"</span>, color<span class="op">=</span><span class="st">"green"</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"No. de simulaci√≥n de Monte Carlo"</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Y"</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Intervalos de confianza por simulaci√≥n"</span>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="09-simulacion-monte-carlo_files/figure-html/cell-12-output-1.png" width="428" height="563" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="ejercicios-propuestos" class="level2">
<h2 class="anchored" data-anchor-id="ejercicios-propuestos">Ejercicios propuestos</h2>
<ol type="1">
<li><p><strong>Semillas y reproducibilidad</strong><br>
Ejecuta dos veces una simulaci√≥n con <code>semilla=None</code> y luego con <code>semilla=1</code>.</p>
<p><strong>Respuesta esperada:</strong> con <code>None</code> obtienes resultados diferentes; con <code>1</code> obtienes resultados id√©nticos.</p></li>
<li><p><strong>TLC: cambia n</strong><br>
Repite la simulaci√≥n de promedios con <code>n=5</code>, <code>n=30</code> y <code>n=100</code>.</p>
<p><strong>Respuesta esperada:</strong> el histograma del promedio se vuelve cada vez m√°s parecido a una normal.</p></li>
<li><p><strong>Ley de grandes n√∫meros</strong><br>
Aumenta <code>nmax</code> y mira el gr√°fico del promedio.</p>
<p><strong>Respuesta esperada:</strong> la serie se estabiliza alrededor de <code>E(Y)=m</code>.</p></li>
<li><p><strong>Error tipo I con m√°s r</strong><br>
Cambia <code>r</code> a 500 o 1000 y calcula la proporci√≥n <code>sum(error1)/r</code>.</p>
<p><strong>Respuesta esperada:</strong> la proporci√≥n se acerca a <code>alpha</code> (‚âà 0.05).</p></li>
<li><p><strong>Cobertura del IC</strong><br>
Con <code>r=1000</code>, calcula <code>1 - sum(intervalo_mal)/r</code>.</p>
<p><strong>Respuesta esperada:</strong> la cobertura se acerca a <code>1-alpha</code> (‚âà 0.95).</p></li>
<li><p><strong>Exploraci√≥n</strong><br>
Cambia <code>n</code> de 10 a 30 en la simulaci√≥n t.</p>
<p><strong>Respuesta esperada:</strong> los intervalos se vuelven (en promedio) m√°s estrechos y la cobertura se mantiene cercana a 0.95.</p></li>
</ol>
<hr>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/08-python-avanzado-condicionales-bucles-funciones-sympy.html" class="pagination-link" aria-label="Cap√≠tulo 8 ‚Äî Python avanzado: condicionales, bucles, funciones y SymPy">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Cap√≠tulo 8 ‚Äî Python avanzado: condicionales, bucles, funciones y SymPy</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




</body></html>